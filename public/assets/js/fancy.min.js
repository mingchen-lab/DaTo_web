/*
All of the code within the FancyGrid software is developed and copyrighted by FancyGrid, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from FancyGrid. All usage must coincide with the
FancyGrid End User License Agreement which can be requested by email at support@fancygrid.com.

Build: 1.2.5
*/

var Fancy = {
    global: this,
    cls: "fancy",
    version: "1.2.5",
    site: "bis.zju.edu.com"
};
Fancy.apply = function(a, b) {
    for (var c in b)
        a[c] = b[c]
}, Fancy.applyIf = function(a, b) {
    for (var c in b)
        void 0 === a[c] && (a[c] = b[c])
}, Fancy.namespace = function() {
    for (var a = 0, b = arguments.length; b > a; a++) {
        var c = arguments[a], d = c.split("."), e = 1, f = d.length;
        Fancy.global[d[0]] = Fancy.global[d[0]] || {};
        for (var g = Fancy.global[d[0]]; f > e; e++)
            g[d[e]] = g[d[e]] || {}, g = g[d[e]]
    }
}, Fancy.ns = Fancy.namespace, Fancy.typeOf = function(a) {
    if (null === a)
        return "null";
    var b = typeof a;
    if ("undefined" === b || "string" === b || "number" === b || "boolean" === b)
        return b;
    var c = Object.prototype.toString, d = c.call(a);
    if (void 0 !== a.length && "function" != typeof a)
        return "array";
    switch (d) {
    case"[object Array]":
        return "array";
    case"[object Date]":
        return "date";
    case"[object Boolean]":
        return "boolean";
    case"[object Number]":
        return "number";
    case"[object RegExp]":
        return "regexp"
    }
    return "function" === b ? "function" : "object" === b ? "object" : void 0
}, Fancy.isArray = "isArray"in Array ? Array.isArray : function(a) {
    var b = Object.prototype.toString;
    return "[object Array]" === b.call(a)
}, Fancy.isObject = function(a) {
    var b = Object.prototype.toString;
    return "[object Object]" === b.call(a)
}, Fancy.isFunction = function(a) {
    var b = Object.prototype.toString;
    return "[object Function]" === b.apply(a)
}, Fancy.isString = function(a) {
    return "string" == typeof a
}, Fancy.isNumber = function(a) {
    return "number" == typeof a && isFinite(a)
}, Fancy.isBoolean = function(a) {
    return "boolean" == typeof a
}, Fancy.each = function(a, b) {
    var c = Fancy.typeOf(a);
    switch (c) {
    case"array":
        for (var d = 0, e = a.length; e > d; d++)
            b(a[d], d, a);
        break;
    case"object":
        for (var f in a)
            b(a[f], f, a)
    }
}, Fancy.mixin = function(a, b) {
    var c = 0, d = b.length;
    if ("object" === Fancy.typeOf(b[0]))
        for (; d > c; c++)
            for (var e = b[c], f = e._class, g = e.methods, h = 0, i = g.length; i > h; h++) {
                var j = g[h];
                a[j] = f.prototype[j]
            } else 
                for (; d > c; c++) {
                    var e = b[c];
                    if (Fancy.isString(e)) {
                        var k = Fancy.ClassManager.getMixin(e);
                        k ? Fancy.apply(a, k.prototype) : Fancy.ClassManager.waitMixin(e, a)
                    } else 
                        Fancy.apply(a, e.prototype)
                }
            }, Fancy.Mixin = function(a, b) {
    var c = a.split("."), d = 1, e = c.length - 1;
    Fancy.ns(a);
    for (var f = Fancy.global[c[0]]; e > d; d++)
        f = f[c[d]];
    c.length > 1 ? (f[c[c.length - 1]] = function() {}, f[c[c.length - 1]].prototype = b) : (Fancy.global[c[0]] = function() {}, Fancy.global[c[0]].prototype = b);
    var g = Fancy.ClassManager.waitMixins[a];
    if (g) {
        g = g.waiters;
        for (var d = 0, e = g.length; e > d; d++)
            Fancy.apply(g[d], b)
    }
}, Fancy.applyConfig = function(a, b) {
    var c, b = b || {};
    if (a._isConfigApplied===!0)
        return a;
    for (c in b)
        a[c] = b[c];
    return a._isConfigApplied=!0, a
}, Fancy.styleToString = function(a) {
    var b = "";
    a = a || {};
    for (var c in a)
        b += c + ": " + a[c] + ";";
    return b
}, Fancy.apply(Fancy, {
    prefix: "fancy-gen-",
    idSeed: 0,
    zIndex: 1,
    id: function(a, b) {
        return a ? (a = a.dom || {}, a.id || (a.id = (b || Fancy.prefix) + ++Fancy.idSeed), a.id) : (b || Fancy.prefix) + ++Fancy.idSeed
    }
}), function() {
    var a = navigator.userAgent.toLowerCase(), b = function(b) {
        return b.test(a)
    }, c = b(/opera/), d=!c && b(/msie/);
    Fancy.apply(Fancy, {
        isOpera: c,
        isIE: d
    }), Fancy.getViewSize = function() {
        var a = [];
        return Fancy.isIE ? (a[0] = document.documentElement.clientHeight, a[1] = document.documentElement.clientWidth) : (a[0] = window.innerHeight, a[1] = window.innerWidth), a
    }, Fancy.getScroll = function() {
        var a = document.documentElement, b = document.body;
        return a && (a.scrollTop || a.scrollLeft) ? [a.scrollTop, a.scrollLeft] : b ? [b.scrollTop, b.scrollLeft] : [0, 0]
    }, Fancy.getMouseWheelEventName = function() {
        return "onmousewheel"in document.body ? "mousewheel" : "DOMMouseScroll"
    }, Fancy.getWheelDelta = function(a) {
        var b = 0;
        return a.wheelDelta ? b = a.wheelDelta / 120 : a.detail && (b =- a.detail / 3), b
    }, Fancy.isTouch = void 0 !== document.ontouchstart, Fancy.i18n = {}, Fancy.currencies = {
        map: {
            EUR: "€",
            USD: "$",
            GBP: "£",
            RUB: "₽",
            CZK: "Kč",
            AUD: "$",
            JPY: "¥",
            PLN: "zł",
            TRY: "₺",
            DKK: "kr",
            KRW: "₩",
            BRL: "R$",
            CNY: "¥",
            SEK: "kr",
            CAD: "$",
            NOK: "kr",
            IDR: "Rp"
        }
    }
}(), Fancy.modules = {}, function() {
    var a = {};
    Fancy.loadModule = function(b, c) {
        var d = document.getElementsByTagName("body")[0], e = document.createElement("script"), f = b, g = Fancy.DEBUG ? ".js": ".min.js", c = c || function() {}, h = location.protocol, i = Fancy.version.replace(/\./g, ""), j = Fancy.MODULESDIR || FancyGrid.MODULESDIR || h + "assets/js/";
        Fancy.MODULELOAD!==!1 && (b = b.replace(/ /g, "-"), g += Fancy.DEBUG ? "?_dc=" + + new Date : "?_v=" + i, Fancy.Modules.on("loaded", function(a, d) {
            d === b && (Fancy.modules[f]=!0, c(b))
        }), a[b] || (a[b]=!0, e.src = j + b + g, e.charset = "utf-8", e.onload = function() {
            Fancy.Modules.fire("loaded", b)
        }, e.onerror = function() {
            throw new Error("[FancyGrid error] - module " + b + " was not loaded")
        }, d.appendChild(e)))
    }, Fancy.loadLang = function(a, b) {
        if (void 0 !== Fancy.i18n[a])
            return !0;
        var c = document.getElementsByTagName("body")[0], d = document.createElement("script"), e = ".js", f = location.protocol, g = Fancy.MODULESDIR || FancyGrid.MODULESDIR || f + "";
        d.src = g + "i18n/" + a + e, d.charset = "utf-8", d.async = "true", d.onload = function() {
            b({
                lang: Fancy.i18n[a]
            })
        }, c.appendChild(d)
    }
}(), Fancy.themes = {}, Fancy.defineTheme = function(a, b) {
    var c = {};
    b.extend ? Fancy.apply(c, Fancy.getTheme(b.extend).config) : "default" !== a && Fancy.apply(c, Fancy.getTheme("default").config), Fancy.apply(c, b.config), b.config = c, Fancy.themes[a] = b
}, Fancy.getTheme = function(a) {
    var b = {
        config: {}
    };
    return Fancy.isObject(a) ? (Fancy.applyIf(b, Fancy.themes[a.name || "default"]), Fancy.apply(b.config, Fancy.themes[a.name || "default"].config), Fancy.apply(b.config, a.config), b) : Fancy.themes[a]
}, Fancy.defineTheme("default", {
    config: {
        cellHeaderHeight: 30,
        cellWidth: 70,
        minCellWidth: 40,
        cellHeight: 32,
        titleHeight: 42,
        subTitleHeight: 42,
        barHeight: 38,
        bottomScrollHeight: 12,
        minCenterWidth: 100,
        panelBorderWidth: 2,
        groupRowHeight: 31,
        gridBorders: [1, 1, 1, 1],
        gridWithoutPanelBorders: [1, 1, 1, 1],
        panelBodyBorders: [2, 2, 2, 2],
        knobOffSet: 2,
        fieldHeight: 37
    }
}), Fancy.defineTheme("blue", {
    config: {
        panelBorderWidth: 1,
        gridBorders: [1, 1, 0, 1],
        gridWithoutPanelBorders: [1, 1, 1, 1],
        panelBodyBorders: [0, 0, 0, 0]
    }
}), Fancy.defineTheme("gray", {
    config: {
        panelBorderWidth: 0,
        gridBorders: [0, 0, 1, 0],
        panelBodyBorders: [0, 0, 0, 0],
        gridWithoutPanelBorders: [1, 1, 1, 1]
    }
}), Fancy.defineTheme("dark", {
    config: {
        panelBorderWidth: 1,
        gridBorders: [0, 1, 1, 1],
        gridWithoutPanelBorders: [1, 1, 1, 1],
        panelBodyBorders: [0, 0, 1, 0]
    }
}), Fancy.defineTheme("sand", {
    config: {
        panelBorderWidth: 1,
        gridBorders: [0, 1, 1, 1],
        gridWithoutPanelBorders: [1, 1, 1, 1],
        panelBodyBorders: [0, 0, 0, 0]
    }
}), Fancy.String = {
    format: function(a) {
        var b, c, d;
        if ("array" === Fancy.typeOf(arguments[1]))
            b = arguments[1];
        else 
            for (d = arguments.length, b = [], c = 1; d > c; c++)
                b[c - 1] = arguments[c];
        return a.replace(/\[(\d+)]/g, function(a, c) {
            return b[c]
        })
    },
    upFirstChar: function(a) {
        return a[0].toLocaleUpperCase() + a.substr(1, a.length)
    },
    trim: function(a) {
        return a.replace(/\s/g, "")
    }
}, Fancy.Array = {
    copy: function(a) {
        return a.slice()
    }
}, Fancy.Object = {
    copy: function(a) {
        var b = {};
        for (var c in a)
            b[c] = a[c];
        return b
    }
}, Fancy.Collection = function(a) {
    var b = this;
    if (b.items = [], b.keys = [], b.map = {}, b.indexMap = {}, b.length = 0, a)
        if (a.length > 0)
            for (var c = 0, d = a.length; d > c; c++)
                b.add(c, a[c]);
        else 
            for (var e in a)
                b.add(e, a[e])
}, Fancy.Collection.prototype = {
    add: function(a, b) {
        var c = this;
        c.items.push(b), c.keys.push(a), c.map[a] = b, c.indexMap[a] = c.length, c.length++
    },
    remove: function(a) {
        var b = this, c = b.indexMap[a];
        b.items.splice(c, 1), b.keys.splice(c, 1), delete b.indexMap[c], delete b.map[a], b.length--
    },
    removeAll: function() {
        var a = this;
        a.items = [], a.keys = [], a.indexMap = {}, a.map = {}, a.length = 0
    },
    get: function(a) {
        var b = this;
        return b.map[a]
    },
    each: function(a) {
        for (var b = this, c = 0, d = b.length; d > c; c++)
            a(b.keys[c], b.items[c], c, b.length)
    }
}, Fancy.Template = function(a) {
    var b = this;
    Fancy.isArray(a) ? b.tpl = a.join("") : b.tpl = a, b.compile()
}, Fancy.Template.prototype = {
    re: /\{([\w\-]+)\}/g,
    getHTML: function(a) {
        var b = this;
        return b.compiled(a)
    },
    compile: function() {
        function fn(a, b) {
            return b = "values['" + b + "']", "'+(" + b + " === undefined ? '' : " + b + ")+'"
        }
        var me = this, sep = "+";
        return eval("me.compiled = function(values){ return '" + me.tpl.replace(me.re, fn) + "';};"), me
    }
}, Fancy.key = {
    BACKSPACE: 8,
    TAB: 9,
    ENTER: 13,
    RETURN: 13,
    SHIFT: 16,
    CTRL: 17,
    ALT: 18,
    ESC: 27,
    END: 35,
    HOME: 36,
    LEFT: 37,
    UP: 38,
    RIGHT: 39,
    DOWN: 40,
    INSERT: 45,
    DELETE: 46,
    ZERO: 48,
    ONE: 49,
    TWO: 50,
    THREE: 51,
    FOUR: 52,
    FIVE: 53,
    SIX: 54,
    SEVEN: 55,
    EIGHT: 56,
    NINE: 57,
    NUM_ZERO: 96,
    NUM_ONE: 97,
    NUM_TWO: 98,
    NUM_THREE: 99,
    NUM_FOUR: 100,
    NUM_FIVE: 101,
    NUM_SIX: 102,
    NUM_SEVEN: 103,
    NUM_EIGHT: 104,
    NUM_NINE: 105,
    NUM_PLUS: 107,
    NUM_MINUS: 109,
    A: 65,
    B: 66,
    C: 67,
    D: 68,
    E: 69,
    F: 70,
    G: 71,
    H: 72,
    I: 73,
    J: 74,
    K: 75,
    L: 76,
    M: 77,
    N: 78,
    O: 79,
    P: 80,
    Q: 81,
    R: 82,
    S: 83,
    T: 84,
    U: 85,
    V: 86,
    W: 87,
    X: 88,
    Y: 89,
    Z: 90
}, Fancy.Key = {
    isNum: function(a) {
        var b = Fancy.key;
        switch (a) {
        case b.ZERO:
        case b.ONE:
        case b.TWO:
        case b.THREE:
        case b.FOUR:
        case b.FIVE:
        case b.SIX:
        case b.SEVEN:
        case b.EIGHT:
        case b.NINE:
        case b.NUM_ZERO:
        case b.NUM_ONE:
        case b.NUM_TWO:
        case b.NUM_THREE:
        case b.NUM_FOUR:
        case b.NUM_FIVE:
        case b.NUM_SIX:
        case b.NUM_SEVEN:
        case b.NUM_EIGHT:
        case b.NUM_NINE:
            return !0;
        default:
            return !1
        }
    },
    isNumControl: function(a, b) {
        var c = Fancy.key;
        if (Fancy.Key.isNum(a))
            return !0;
        if (b.shiftKey && 187 === a)
            return !0;
        switch (a) {
        case c.NUM_PLUS:
        case 189:
        case c.NUM_MINUS:
        case c.BACKSPACE:
        case c.DELETE:
        case c.TAB:
        case c.ENTER:
        case c.RETURN:
        case c.SHIFT:
        case c.CTRL:
        case c.ALT:
        case c.ESC:
        case c.END:
        case c.HOME:
        case c.LEFT:
        case c.UP:
        case c.RIGHT:
        case c.DOWN:
        case c.INSERT:
            return !0;
        default:
            return !1
        }
    }
}, function() {
    var a = {}, b = {}, c = function(a, b) {
        for (var c in b.prototype)
            void 0 === a.prototype[c] && (a.prototype[c] = b.prototype[c])
    }, d = function() {
        this.waitMixins = {}
    };
    d.prototype = {
        items: new Fancy.Collection,
        add: function(a, b) {
            var c = a.split("."), d = 1, e = c.length - 1;
            Fancy.ns(a);
            for (var f = Fancy.global[c[0]]; e > d; d++)
                f = f[c[d]];
            c.length > 1 ? f[c[c.length - 1]] = b : Fancy.global[c[0]] = b, this.items.add(a, b)
        },
        get: function(a) {
            return this.items.get(a)
        },
        waitMixin: function(a, b) {
            var c = this;
            c.waitMixins[a] = c.waitMixins[a] || {
                waiters: []
            }, c.waitMixins[a].waiters.push(b)
        },
        getMixin: function(a) {
            var b = a.split("."), c = 1, d = b.length, e = Fancy.global[b[0]];
            if (void 0 === e)
                return !1;
            for (; d > c; c++)
                if (e = e[b[c]], void 0 === e)
                    return !1;
            return e
        }
    }, Fancy.ClassManager = new d, Fancy.define = function(d, e) {
        var e = e || {}, f = [];
        if (Fancy.isArray(d) && (f = d, d = f[0]), e.constructor === Object && (void 0 === e.extend ? e.constructor = function() {} : e.constructor = function() {
            this.Super("constructor", arguments)
        }), void 0 === e.extend)a[d] = e.constructor;
        else {
            a[d] = e.constructor;
            var g;
            switch (typeof e.extend) {
            case"string":
                g = Fancy.ClassManager.get(e.extend), a[d].prototype.$Super = Fancy.ClassManager.get(e.extend);
                break;
            case"function":
                g = e.extend, a[d].prototype.$Super = e.extend
            }
            delete e.extend, a[d].prototype.Super = function(a, b) {
                var c = this;
                switch (c.$Iam ? c.$Iam = Fancy.ClassManager.get(c.$Iam.prototype.$Super.prototype.$name) : c.$Iam = Fancy.ClassManager.get(c.$Super.prototype.$name), a) {
                case"const":
                case"constructor":
                    c.$Iam.apply(c, b);
                    break;
                default:
                    c.$Iam.prototype[a].apply(c, b)
                }
                delete c.$Iam
            }, c(a[d], g)
        }
        a[d].prototype.$name = d, e.mixins && (Fancy.mixin(a[d].prototype, e.mixins), delete a[d].prototype.mixins), void 0 !== e.plugins && (void 0 === a[d].prototype.$plugins && (a[d].prototype.$plugins = []), a[d].prototype.$plugins = a[d].prototype.$plugins.concat(e.plugins), delete a[d].prototype.plugins);
        for (var h in e)
            a[d].prototype[h] = e[h];
        var i = a[d];
        e.singleton===!0 && (delete a[d], i = new i(e), a[d] = i), f.length > 1 ? Fancy.each(f, function(a) {
            Fancy.ClassManager.add(a, i)
        }) : Fancy.ClassManager.add(d, i), e.type ? (b[e.type] = i, Fancy.addWidgetType(e.type, i)) : e.ptype && (b[e.type] = i, Fancy.addPluginByType(e.ptype, i))
    }, Fancy.getClassByType = function(a) {
        return b[a]
    }
}(), Fancy.MixinClass = function() {}, Fancy.MixinClass.prototype = {
    initId: function() {
        var a = this, b = a.prefix || Fancy.prefix;
        a.id = a.id || Fancy.id(null, b), Fancy.addWidget(a.id, a)
    },
    initPlugins: function() {
        var a, b, c, d = this, e = d;
        if (d.plugins = d.plugins || [], d._plugins && (d.plugins = d.plugins.concat(d._plugins)), void 0 !== d.plugins && (d.$plugins = d.plugins, delete d.plugins), void 0 !== d.$plugins)for (var f, g = 0, h = d.$plugins, i = h.length, j = {}; i > g; g++) {
            c = h[g], c.widget = e;
            var k = c.type || c.ptype;
            if (j[k]!==!0) {
                if (j[k]=!0, a = Fancy.getPluginByType(k), void 0 === a)
                    throw new Error("[FancyGrid Error] - some of module was not loaded. Grid plugin does not exist - " + k);
                b = new a(c), f = c.inWidgetName || b.inWidgetName, void 0 !== f && (e[f] = b)
            }
        }
    }
}, Fancy.define("Fancy.Data", {
    constructor: function(a) {
        var b = this;
        if (b.map = {}, a)
            for (var c = 0, d = a.length, e = b.map; d > c; c++)
                e[c] = a[c];
        b.length = 0
    },
    add: function(a, b) {
        var c = this;
        c.map[a] = b, c.length++
    },
    get: function(a) {
        return this.map[a]
    }
}), Fancy.define("Fancy.Model", {
    constructor: function(a) {
        var b = this, c = {}, d = b.fields || [], e = 0, f = d.length;
        if (Fancy.isArray(a)) {
            for (; f > e; e++) {
                var g = d[e];
                c[g] = a[e]
            }
            b.data = c
        } else {
            if (a.id ? b.id = a.id : (Fancy.idSeed++, b.id = Fancy.idSeed + 1e3), void 0 === b.fields) {
                d = [];
                for (var g in a)
                    d.push(g);
                b.fields = d
            }
            for (f = d.length; f > e; e++) {
                var g = d[e];
                void 0 === a[g] ? c[g] = "" : c[g] = a[g]
            }
            b.data = c
        }
    },
    get: function(a) {
        var b = this;
        return void 0 === a ? b.data : b.data[a]
    },
    set: function(a, b) {
        var c = this;
        if (void 0 === b && Fancy.isObject(a)
            )for (var d in a)
            c.set(d, a[d]);
        else 
            c.data[a] = b
    }
}), Fancy.define("Fancy.PluginManager", {
    singleton: !0,
    constructor: function() {
        var a = this;
        a.ptypes = new Fancy.Data
    },
    addPlugin: function(a, b) {
        this.ptypes.add(a, b)
    },
    getPlugin: function(a) {
        return this.ptypes.get(a)
    }
}), Fancy.addPluginByType = function(a, b) {
    Fancy.PluginManager.addPlugin(a, b)
}, Fancy.getPluginByType = function(a) {
    return Fancy.PluginManager.getPlugin(a)
}, Fancy.define("Fancy.WidgetManager", {
    singleton: !0,
    constructor: function() {
        var a = this;
        a.wtypes = new Fancy.Data, a.widgets = new Fancy.Data
    },
    addWidgetType: function(a, b) {
        b.prototype.wtype = a, this.wtypes.add(a, b)
    },
    getWidgetClassByType: function(a) {
        return this.wtypes.get(a)
    },
    addWidget: function(a, b) {
        this.widgets.add(a, b)
    },
    getWidget: function(a) {
        return this.widgets.get(a)
    }
}), Fancy.addWidgetType = function(a, b) {
    Fancy.WidgetManager.addWidgetType(a, b)
}, Fancy.getWidgetClassByType = function(a) {
    return Fancy.WidgetManager.getWidgetClassByType(a)
}, Fancy.addWidget = function(a, b) {
    Fancy.WidgetManager.addWidget(a, b)
}, Fancy.getWidget = function(a) {
    return Fancy.WidgetManager.getWidget(a)
}, function() {
    var a = 0, b = {};
    Fancy.define(["Fancy.Event", "Fancy.Observable"], {
        mixins: [Fancy.MixinClass],
        constructor: function(a) {
            var b = this;
            if (Fancy.applyConfig(b, a || {}), b.$events = {}, b.listeners || b.events)
                for (var c = b.listeners || b.events, d = 0, e = c.length; e > d; d++) {
                    var f = c[d], g = null, h = null, i = null, j = [];
                    for (var k in f)
                        "scope" === k ? i = f[k] : "params" === k ? j = f[k] : (g = k, h = f[k]);
                        if (null === g)
                            throw new Error("Event was not set");
                            switch (Fancy.typeOf(h)) {
                            case"string":
                                h = b[h], f.handler = h, void 0 === f.scope && (i = b), f.scope = i;
                                break;
                            case"function":
                                break;
                            default:
                                throw new Error("Handler has wrong type or not defined")
                            }
                            if (Fancy.isArray(j)===!1)
                                throw new Error("params must be array");
                                b.addEvent(g), b.on(g, h, i, j)
                        }
            },
        on: function(c, d, e, f) {
            if (void 0 === this.$events[c])
                throw new Error("Event name is not set: " + c);
            if (void 0 === d)
                throw new Error("Handler is undefined. Name of event is " + c + ".");
            d.$fancyFnSeed = a, b[a] = d, a++, this.$events[c].push({
                fn: d,
                scope: e,
                params: f || []
            })
        },
        un: function(a, b) {
            var c = this, d = c.$events[a];
            if (!d)
                return !1;
            for (var e = 0, f = d.length; f > e; e++) {
                var g = d[e];
                if (g.fn.$fancyFnSeed === b.$fancyFnSeed)
                    return g.toRemove=!0, !0
            }
            return !1
        },
        once: function(a, b, c) {
            var d = this, e = function() {
                b.apply(this, arguments), d.un(a, e)
            };
            d.on(a, e, c)
        },
        unAll: function() {
            this.$events = {}
        },
        unAllByType: function(a) {
            this.$events[a] = []
        },
        fire: function(a) {
            var b = this, c = b.$events[a];
            if (!c)
                return !1;
            for (var d = 1, e = arguments.length, f = [b]; e > d; d++)
                f.push(arguments[d]);
            for (var d = 0, e = c.length; e > d; d++) {
                var g = c[d], h = [];
                g.toRemove!==!0 ? (h = h.concat(f), g.params && (h = h.concat(g.params)), g.fn.apply(g.scope || b, h)) : (c.splice(d, 1), d--, e = c.length)
            }
        },
        addEvent: function(a) {
            return this.addEvents(a)
        },
        addEvents: function(a) {
            var b = this;
            if (arguments.length > 1) {
                for (var c = [], d = 0, e = arguments.length; e > d; d++)
                    c[d] = arguments[d];
                a = c
            }
            if ("string" === Fancy.typeOf(a))
                b.$events[a] = b.$events[a] || [];
            else if ("array" === Fancy.typeOf(a))
                for (var d = 0, e = a.length; e > d; d++)
                    b.$events[a[d]] = b.$events[a[d]] || []
        },
        has: function(a) {
            var b = this.$events[a];
            return b ? 0 !== b.length : !1
        }
    }), Fancy.define("Fancy.Modules", {
        extend: Fancy.Event,
        singleton: !0,
        constructor: function() {
            var a = this;
            a.Super("const", arguments), a.init()
        },
        init: function() {
            var a = this;
            a.addEvents("loaded")
        }
    })
}(), Fancy.Mixin("Fancy.store.mixin.Dirty", {
    initTrackDirty: function() {
        var a = this;
        a.changed = {
            length: 0
        }, a.removed = {
            length: 0
        }, a.inserted = {
            length: 0
        }, a.on("remove", a.onDirtyRemove, a), a.on("set", a.onDirtySet, a), a.on("insert", a.onDirtyInsert, a)
    },
    onDirtySet: function(a, b) {
        var c = this, d = b.id;
        void 0 === c.changed[d] ? (c.changed[d] = {
            length: 1
        }, c.changed.length++) : c.changed[d].length++, void 0 === c.changed[d][b.key] && (c.changed[d][b.key] = {
            originValue: b.oldValue
        }), c.changed[d][b.key].value = b.value, c.changed[d][b.key].value === c.changed[d][b.key].originValue && (delete c.changed[d][b.key], c.changed[d].length--), 0 === c.changed[d].length && (delete c.changed[d], c.changed.length--)
    },
    onDirtyRemove: function(a, b, c) {
        var d = this;
        d.removed[b] = c.data, d.removed.length++
    },
    onDirtyInsert: function(a, b) {
        var c = this;
        c.inserted[b.id] = b, c.inserted.length++
    }
}), Fancy.define("Fancy.Store", {
    extend: Fancy.Event,
    mixins: ["Fancy.store.mixin.Paging", "Fancy.store.mixin.Proxy", "Fancy.store.mixin.Rest", "Fancy.store.mixin.Reader", "Fancy.store.mixin.Writer", "Fancy.store.mixin.Sort", "Fancy.store.mixin.Edit", "Fancy.store.mixin.Grouping", "Fancy.store.mixin.Filter", "Fancy.store.mixin.Search", "Fancy.store.mixin.Dirty"],
    pageSize: 10,
    showPage: 0,
    pages: 0,
    dirty: !1,
    constructor: function() {
        var a = this;
        a.Super("const", arguments), a.init(), a.data = a.data || [], a.dataView = a.dataView || [], a.dataViewMap = a.dataViewMap || {}, a.map = {}, a.setModel(), a.data && (a.data.proxy ? a.initProxy() : a.setData(a.data))
    },
    init: function() {
        var a = this;
        a.addEvents("add", "change", "changepages", "set", "beforeupdate", "update", "beforeremove", "remove", "beforedestroy", "destroy", "beforecreate", "create", "sort", "beforeload", "load", "filter", "insert"), a.initId(), a.initPlugins(), a.paging && a.initPaging(), a.initTrackDirty && a.initTrackDirty()
    },
    setModel: function() {
        var a = this, b = a.model;
        if (b = void 0 === b ? Fancy.Model : Fancy.ClassManager.get(a.model), a.model = b, a.fields = b.prototype.fields, void 0 === a.fields)throw new Error("needed to set fields in Model of Store")
    },
    setData: function(a) {
        var b, c = this, d = 0, e = a.length, f = c.model;
        if (c.data = [], c.dataView = [], c.dataViewMap = {}, c.dataViewIndexes = {}, c.collapsed)
            for (; e > d; d++)
                b = new f(a[d]), b.$index = d, c.data[d] = b, c.map[b.id] = b;
        else if (c.expanded)
            for (; e > d; d++)
                b = new f(a[d]), b.$index = d, c.data[d] = b, c.map[b.id] = b;
        else if (c.paging)
            for (; e > d; d++)
                b = new f(a[d]), b.$index = d, c.data[d] = b, d < c.pageSize && (c.dataView[d] = b, c.dataViewMap[b.id] = d, c.dataViewIndexes[d] = d), c.map[b.id] = b;
        else 
            for (; e > d; d++)
                b = new f(a[d]), b.$index = d, c.data[d] = b, c.dataView[d] = b, c.dataViewMap[b.id] = d, c.dataViewIndexes[d] = d, c.map[b.id] = b
    },
    getItem: function(a) {
        var b = this;
        return b.dataView[a]
    },
    get: function(a, b) {
        var c, d = this;
        return void 0 === a ? d.data : void 0 === b ? (c = d.dataView[a].data, void 0 === c.id && (c.id = d.dataView[a].id), d.dataView[a].data) : "none" === b ? "" : d.dataView[a].data[b]
    },
    getId: function(a) {
        return this.dataView[a].id
    },
    getRow: function(a) {
        return this.dataViewMap[a]
    },
    set: function(a, b, c) {
        var d = this, e = d.dataView[a], f = e.data.id || e.id, g = d.get(a, b, c);
        g !== c && (d.dataView[a].data[b] = c, "server" === d.proxyType && d.autoSave && d.proxyCRUD("UPDATE", f, b, c), d.fire("set", {
            id: f,
            data: d.dataView[a].data,
            rowIndex: a,
            key: b,
            value: c,
            oldValue: g,
            item: e
        }))
    },
    setItemData: function(a, b) {
        var c = this;
        for (var d in b)
            c.set(a, d, b[d])
    },
    getLength: function() {
        return this.dataView.length
    },
    getTotal: function() {
        var a = this;
        return "server" === a.pageType ? a.totalCount : a.filteredData ? a.filteredData.length : a.data.length
    },
    defineModel: function(a) {
        var b = this, c = b.store;
        if (!b.model ||!b.fields || 0 === b.fields.length) {
            var a = a || b.data || c.data, d = b.getFieldsFromData(a), e = "Fancy.model." + Fancy.id();
            Fancy.define(e, {
                extend: Fancy.Model,
                fields: d
            }), b.model = e, b.fields = d, b.setModel()
        }
    },
    getFieldsFromData: function(a) {
        var b = a.items || a;
        if (a.fields)
            return a.fields;
        if (!b)
            throw new Error("not set fields of data");
        var c = b[0], d = [];
        for (var e in c)
            d.push(e);
        return d
    },
    getColumnOriginalValues: function(a, b) {
        var c = this, d = c.data, e = 0, f = d.length, g = [], b = b || {};
        if (b.smartIndexFn)
            for (; f > e; e++)
                g.push(b.smartIndexFn(d[e].data));
        else if (b.format)
            if ("date" === b.type)
                for (; f > e; e++)
                    g.push(Fancy.Date.parse(d[e].data[a], b.format));
            else 
                for (; f > e; e++)
                    g.push(d[e].data[a]);
        else 
            for (; f > e; e++)
                g.push(d[e].data[a]);
        return g
    },
    changeDataView: function() {
        var a, b = this, c = [], d = {}, e = 0, f = b.data.length, g=!!b.filters, h=!!b.searches, i = b.data;
        g && (b.filterData(), i = b.filteredData, f = i.length), h && (b.searchData(), i = b.searchedData, f = i.length), b.dataViewIndexes = {}, b.dataViewMap = {}, b.paging && (e = "server" === b.pageType ? 0 : b.showPage * b.pageSize, f = e + b.pageSize);
        var j = b.getTotal();
        f > b.data.length && (f = b.data.length), g && f > j && (f = j), Fancy.isObject(b.data) && (f = 0);
        var k;
        if (b.order)
            if (b.grouping)
                for (a = b.grouping.by; f > e; e++)
                    b.expanded[b.data[b.order[e]].data[a]] && (g===!0 ? (b.dataViewIndexes[c.length] = b.filterOrder[e], k = i[e]) : (b.dataViewIndexes[c.length] = b.order[e], k = i[b.order[e]]), c.push(k), d[k.id] = c.length - 1);
            else 
                for (; f > e; e++)
                    g===!0 ? (b.dataViewIndexes[c.length] = b.filterOrder[e], k = i[e]) : (b.dataViewIndexes[c.length] = b.order[e], k = i[b.order[e]]), c.push(k), d[k.id] = c.length - 1;
        else if (b.grouping)
            for (a = b.grouping.by; f > e; e++)
                b.expanded[b.data[e].data[a]] && (b.dataViewIndexes[c.length] = e, k = i[e], c.push(k), d[k.id] = c.length - 1);
        else 
            for (; f > e; e++)
                b.dataViewIndexes[c.length] = e, k = i[e], c.push(i[e]), d[k.id] = c.length - 1;
        b.dataView = c, b.dataViewMap = d, b.fire("change")
    },
    getColumnData: function(a, b) {
        var c = this, d = 0, e = c.data.length, f = [];
        if (b)
            for (; e > d; d++)
                f.push(b(c.data[d].data));
        else 
            for (; e > d; d++)
                f.push(c.data[d].data[a]);
        return f
    },
    getData: function() {
        for (var a = this, b = 0, c = a.data.length, d = []; c > b; b++)
            d.push(a.data[b].data);
        return d
    },
    getDataView: function() {
        for (var a = this, b = 0, c = a.dataView.length, d = []; c > b; b++)
            d.push(a.dataView[b].data);
        return d
    },
    getById: function(a) {
        var b = this;
        return b.map[a]
    },
    changeItemId: function(a, b) {
        var c = this, d = c.getById(a);
        return d ? (d.id = b, void 0 !== d.data.id && (d.data.id = b), delete c.map[a], c.map[b] = d, void c.fire("changeitemid", a, b)) : !1
    },
    find: function(a, b) {
        for (var c, d = this, e = d.dataView, f = 0, g = e.length, h = []; g > f; f++)
            c = e[f], c.data[a] === b && h.push(f);
        return h
    },
    findItem: function(a, b) {
        for (var c, d = this, e = d.data, f = 0, g = e.length, h = []; g > f; f++)
            c = e[f], c.data[a] === b && h.push(c);
        return h
    },
    getDataIndex: function(a) {
        for (var b, c, d = this, e = d.data, f = 0, g = e.length; g > f; f++)
            b = e[f], b.data.id === a && (c = f);
        return c
    },
    each: function(a, b) {
        var c = this, d = c.dataView, e = 0, f = d.length;
        if (b)
            for (; f > e; e++)
                a.apply(this, [d[e]]);
        else 
            for (; f > e; e++)
                a(d[e])
    }
}), Fancy.$ = window.$ || window.jQuery, void 0 === Fancy.$ ? Fancy.nojQuery=!0 : Fancy.nojQuery=!1, Fancy.get = function(a) {
    var b = Fancy.typeOf(a);
    switch (b) {
    case"string":
        return new Fancy.Element(Fancy.$("#" + a)[0]);
    case"array":
        return new Fancy.Elements(a);
    default:
        return new Fancy.Element(a)
    }
}, Fancy.Element = function(a) {
    var b = this;
    b.dom = a, b.$dom = Fancy.$(a), b.length = 1
}, Fancy.Element.prototype = {
    closest: function(a) {
        return Fancy.get(this.$dom.closest(a)[0])
    },
    destroy: function() {
        this.$dom.remove()
    },
    remove: function() {
        this.$dom.remove()
    },
    prev: function() {
        return this.$dom.prev()
    },
    firstChild: function() {
        return Fancy.get(this.$dom.children()[0])
    },
    on: function(a, b, c, d) {
        var e = this;
        c && (b = Fancy.$.proxy(b, c)), d ? e.$dom.on(a, d, b) : e.$dom.on(a, b)
    },
    once: function(a, b, c, d) {
        var e = this;
        c && (b = Fancy.$.proxy(b, c)), d ? e.$dom.one(a, d, b) : e.$dom.one(a, b)
    },
    prop: function(a) {
        return this.$dom.prop(a)
    },
    _on: function(a, b, c, d) {
        var e = this;
        window.addEventListener ? "mousewheel" === a && ZG.mouseWheelWork===!1 ? e.dom.addEventListener("DOMMouseScroll", b, !1) : e.dom.addEventListener(a, b, !1) : e.dom.attachEvent("on" + a, b)
    },
    un: function(a, b, c, d) {
        var e = this;
        c && (b = Fancy.$.proxy(b, c)), d ? e.$dom.off(a, d, b) : e.$dom.off(a, b)
    },
    show: function() {
        this.$dom.show()
    },
    hide: function() {
        this.$dom.hide()
    },
    getByClass: function(a) {
        var b = this;
        return b.$dom.find("." + a)[0]
    },
    getByTag: function(a) {
        var b = this;
        return Fancy.get(b.$dom.find(a)[0])
    },
    addClass: function(a) {
        var b = this;
        b.$dom.addClass(a)
    },
    removeClass: function(a) {
        var b = this;
        b.$dom.removeClass(a)
    },
    hasClass: function(a) {
        var b = this;
        return b.$dom.hasClass(a)
    },
    toggleClass: function(a) {
        var b = this;
        b.$dom.toggleClass(a)
    },
    select: function(a) {
        var b = this, c = b.$dom.find(a);
        return 1 === c.length ? Fancy.get(c[0]) : c.length > 1 ? Fancy.get(c) : 0 === c.length ? {
            length: 0,
            dom: void 0,
            addClass: function() {}, removeClass : function() {}, destroy : function() {}, css: function() {}
        }
        : c
    }, css : function(a, b) {
        return void 0 === b ? this.$dom.css(a) : this.$dom.css(a, b)
    }, attr: function(a, b) {
        return void 0 === b ? this.$dom.attr(a) : this.$dom.attr(a, b)
    }, append: function(a) {
        return Fancy.get(this.$dom.append(a)[0])
    }, before: function(a) {
        return this.$dom.before(a)[0]
    }, height: function(a) {
        return a ? (this.$dom.height(a), this) : this.$dom.height()
    }, width: function(a) {
        return a ? (this.$dom.width(a), this) : this.$dom.width()
    }, parent: function(a) {
        return Fancy.get(this.$dom.parent(a)[0])
    }, update: function(a) {
        this.dom.innerHTML = a
    }, hover: function(a, b) {
        a && this.$dom.on("mouseenter", a), a && this.$dom.on("mouseleave", b)
    }, position: function() {
        return this.$dom.position()
    }, offset: function() {
        return this.$dom.offset()
    }, focus: function() {
        this.$dom.focus()
    }, blur: function() {
        this.$dom.blur()
    }, within: function(a) {
        var b, c = this, d=!0, e=!1;
        return a = Fancy.get(a), b = a.attr("id"), (void 0 === b || "" === b) && (b = Fancy.id(), e=!0), a.attr("id", b), 0 === c.select("#" + b).length && (d=!1), c.dom.id === a.dom.id && (d=!0), e && c.removeAttr(b), d
    }, removeAttr: function(a) {
        this.$dom.removeAttr(a)
    }, item: function() {
        return this
    }, animate: function(a, b, c, d) {
        this.$dom.animate(a, b, c, d)
    }, index: function() {
        return this.$dom.index()
    }
}, Fancy.Elements = function(a) {
    var b = this;
    b.dom = a, b.$dom = a, b.length = a.length
}, Fancy.Elements.prototype = {
    addClass: function(a) {
        for (var b = this, c = 0, d = b.length; d > c; c++)
            Fancy.get(b.$dom[c]).addClass(a)
    },
    removeClass: function(a) {
        for (var b = this, c = 0, d = b.length; d > c; c++)
            Fancy.get(b.$dom[c]).removeClass(a)
    },
    hover: function(a) {
        this.$dom.on("mouseenter", a)
    },
    on: Fancy.Element.prototype.on,
    once: Fancy.Element.prototype.once,
    item: function(a) {
        return Fancy.get(this.$dom[a])
    },
    css: function(a, b) {
        for (var c = this, d = 0, e = c.length; e > d; d++)
            Fancy.get(c.$dom[d]).css(a, b)
    },
    toggleClass: function(a) {
        for (var b = this, c = 0, d = b.length; d > c; c++)
            Fancy.get(b.$dom[c]).toggleClass(a)
    },
    destroy: function() {
        for (var a = this, b = 0, c = a.length; c > b; b++)
            Fancy.get(a.$dom[b]).destroy()
    },
    index: function() {
        return this.$dom[0].index()
    }
}, Fancy.select = function(a) {
    return Fancy.get(document.body).select(a)
}, Fancy.onReady = function(a) {
    $(document).ready(a)
}, Fancy.Ajax = function(a) {
    var b = {};
    a.url && (b.url = a.url), a.success && (b.success = a.success), a.error && (b.error = a.error), a.method && (b.type = a.method), a.params && (b.data = a.params), a.sendJSON && (b.dataType = "json", b.contentType = "application/json; charset=utf-8", b.data = JSON.stringify(b.data)), a.getJSON && (b.dataType = "json", b.contentType = "application/json; charset=utf-8"), a.headers && (b.headers = a.headers), Fancy.$.ajax(b)
}, Fancy.i18n.en = {
    paging: {
        first: "First Page",
        last: "Last Page",
        prev: "Previous Page",
        next: "Next Page",
        info: "Rows [0] - [1] of [2]",
        page: "Page",
        of: "of [0]"
    },
    loadingText: "Loading...",
    thousandSeparator: ",",
    decimalSeparator: ".",
    currencySign: "$",
    sourceText: "Source",
    date: {
        read: "m/d/Y",
        write: "m/d/Y",
        edit: "m/d/Y",
        today: "Today",
        startDay: 0,
        days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
        months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        am: "am",
        pm: "pm",
        AM: "AM",
        PM: "PM",
        ok: "OK",
        cancel: "Cancel"
    }
}, Fancy.i18n["en-US"] = Fancy.i18n.en, Fancy.controllers = {}, Fancy.defineController = function(a, b) {
    Fancy.controllers[a] = b
}, Fancy.getController = function(a) {
    return Fancy.controllers[a]
}, Fancy.define("Fancy.DD", {
    extend: Fancy.Event,
    singleton: !0,
    constructor: function(a) {
        var b = this;
        b.Super("const", arguments), b.init()
    },
    init: function() {
        var a = this;
        a.addEvents(), a.els = {}
    },
    add: function(a) {
        var b = this, c = Fancy.id(a.overEl);
        b.els[c] = a, a.overEl.on("mousedown", b.onMouseDown, b)
    },
    onMouseDown: function(a) {
        var b = this, c = Fancy.get(document), d = Fancy.get(a.currentTarget), e = b.els[d.attr("id")].dragEl;
        a.preventDefault(), b.clientX = a.clientX, b.clientY = a.clientY, b.startX = parseInt(e.css("left")), b.startY = parseInt(e.css("top")), b.activeId = d.attr("id"), c.once("mouseup", b.onMouseUp, b), c.on("mousemove", b.onMouseMove, b)
    },
    onMouseUp: function() {
        var a = this, b = Fancy.get(document);
        b.un("mousemove", a.onMouseMove, a)
    },
    onMouseMove: function(a) {
        var b = this, c = b.els[b.activeId], d = c.dragEl, e = a.clientX, f = a.clientY, g = b.clientX - e, h = b.clientY - f;
        d.css({
            left: b.startX - g,
            top: b.startY - h
        })
    }
}), Fancy.define("Fancy.Widget", {
    extend: Fancy.Event,
    constructor: function(a) {
        var b = this;
        Fancy.applyConfig(b, a || {}), b.preInitControls(), b.Super("const", arguments), b.init(), b.initControls()
    },
    init: function() {
        var a = this;
        a.initId(), a.addEvents("beforerender", "afterrender", "render", "show", "beforehide", "hide", "destroy"), a.initPlugins()
    },
    renderItems: function(a) {
        for (var b = this, c = 0, d = b.items.length; d > c; c++) {
            var e = b.items[c], f = Fancy.getClassByType(e.type);
            e.renderTo = a, b.items[c] = new f(e)
        }
    },
    preInitControls: function() {
        var a = this, b = a.controller || a.controllers;
        if (b)
            switch (Fancy.typeOf(b)) {
            case"string":
                var b = Fancy.getController(b);
                for (var c in b)
                    void 0 === a[c] && (a[c] = b[c]);
                    break;
                case"array":
                    for (var d = [], e = 0, f = b.length; f > e; e++) {
                        var g = Fancy.getController(b[e]);
                        for (var c in g)
                            "controls" !== c ? void 0 === a[c] && (a[c] = g[c]) : d = d.concat(g.controls)
                        }
                        a.controls = d
                }
        },
    initControls: function() {
        var a = this;
        if (void 0 !== a.controls)
            for (var b = a.controls, c = 0, d = b.length; d > c; c++) {
                var e = b[c];
                if (void 0 === e.event)
                    throw new Error("[FancyGrid Error]: - not set event name for control");
                    if (void 0 === e.handler)
                        throw new Error("[FancyGrid Error]: - not set handler for control");
                        var f = e.event, g = e.handler, h = e.scope || a, i = e.selector;
                        Fancy.isString(g) && (g = a[g]), i?!function(b, c, d, e) {
                            a.$events[b] ? a.on(b, function(a, b) {
                                var f = b.e.target, g = Fancy.get(f), h = g.parent(), i = h.select(e);
                                if (1 === i.length && i.within(f))
                                    c.apply(d, arguments);
                                else if (i.length > 1)
                                    for (var j = 0, k = i.length; k > j; j++)
                                        i.item(j).within(f) && c.apply(d, arguments)
                                    }, d) : a.on("render", function() {
                                        a.el.on(b, c, d, e)
                                    })
                                }(f, g, h, i) : void 0 === i && void 0 === e.widget && a.on(f, g, h)
            }
    }
}), Fancy.define("Fancy.Plugin", {
    extend: Fancy.Event,
    constructor: function(a) {
        var b = this;
        b.Super("const", arguments), b.init()
    },
    init: function() {
        var a = this;
        a.initId(), a.addEvents("beforerender", "afterrender", "render", "show", "hide", "destroy")
    }
}), function() {
    var a = {};
    Fancy.define("Fancy.Button", {
        extend: Fancy.Widget,
        minWidth: 43,
        constructor: function(b, c) {
            var d = this;
            b.toggleGroup && (a[b.toggleGroup] = a[b.toggleGroup] || {
                active: !1,
                items: []
            }, a[b.toggleGroup].items.push(d)), d.scope = c, d.Super("const", arguments)
        },
        init: function() {
            var a = this;
            a.addEvents("click", "mousedown", "mouseup", "mouseover", "mouseout"), a.Super("init", arguments), a.style = a.style || {}, a.initTpl(), a.render(), a.setOns()
        },
        setOns: function() {
            var a = this, b = a.el;
            b.on("click", a.onClick, a), b.on("mousedown", a.onMouseDown, a), b.on("mouseup", a.onMouseUp, a), b.on("mouseover", a.onMouseOver, a), b.on("mouseout", a.onMouseOut, a), a.tip && b.on("mousemove", a.onMouseMove, a)
        },
        widgetCls: "fancy-button",
        cls: "",
        disabledCls: "fancy-button-disabled",
        extraCls: "",
        text: "",
        height: 28,
        paddingTextWidth: 5,
        imageWidth: 20,
        tpl: ['<div class="fancy-button-image"></div>', '<a class="fancy-button-text">{text}</a>', '<div class="fancy-button-drop" style="{dropDisplay}"></div>'],
        initTpl: function() {
            var a = this;
            a.tpl = new Fancy.Template(a.tpl)
        },
        render: function() {
            var a, b = this, c = Fancy.get(document.createElement("div")), d = 0;
            if (b.fire("beforerender"), b.wrapper && b.renderWrapper(), a = Fancy.get(b.renderTo || document.body).dom, b.width ? d = b.width : b.text!==!1 && (d += 7 * b.text.length + 14), d < b.minWidth && b.text && b.text.length > 0 && (d = b.minWidth), b.imageCls && (d += b.imageWidth), c.addClass(Fancy.cls), c.addClass(b.widgetCls), c.addClass(b.cls), c.addClass(b.extraCls), b.disabled && c.addClass(b.disabledCls), c.css({
                width: d + "px",
                height: b.height + "px"
            }), c.css(b.style || {}), c.update(b.tpl.getHTML({
                text: b.text || ""
            })), b.imageCls) {
                var e = c.select(".fancy-button-image");
                e.css("display", "block"), e.addClass(b.imageCls)
            }
            b.el = Fancy.get(a.appendChild(c.dom)), Fancy.each(b.style, function(a, c) {
                b.el.css(c, a)
            }), b.disabled && b.disable(), b.pressed && b.setPressed(b.pressed), b.initToggle(), b.fire("afterrender"), b.fire("render")
        },
        renderWrapper: function() {
            var a = this, b = a.wrapper, c = Fancy.get(a.renderTo || document.body).dom, d = Fancy.get(document.createElement("div"));
            d.css(b.style || {}), d.addClass(b.cls || ""), a.wrapper = Fancy.get(c.appendChild(d.dom)), a.renderTo = a.wrapper.dom
        },
        initToggle: function() {
            var a = this;
            !a.enableToggle
        },
        setPressed: function(b) {
            var c = this;
            if (b) {
                if (c.el.addClass("fancy-button-pressed"), c.pressed=!0, c.toggleGroup) {
                    var d = a[c.toggleGroup].active;
                    d && d.setPressed(!1), a[c.toggleGroup].active = c
                }
            } else 
                c.el.removeClass("fancy-button-pressed"), c.pressed=!1
        },
        toggle: function() {
            var a = this, b=!a.pressed;
            a.setPressed(b), a.pressed = b
        },
        onClick: function() {
            var a = this, b = a.handler;
            a.fire("click"), a.disabled!==!0 && (b && (Fancy.isString(b) && (b = a.getHandler(b)), a.scope ? b.apply(a.scope, [a]) : b(a)), a.enableToggle && (a.toggleGroup ? a.setPressed(!0) : a.toggle()))
        },
        getHandler: function(a) {
            var b = this, c = Fancy.getWidget(b.el.parent().parent().select(".fancy-grid").attr("id"));
            return c[a] || function() {
                throw new Error("[FancyGrid Error] - handler does not exist")
            }
        },
        onMouseDown: function() {
            var a = this;
            a.fire("mousedown")
        },
        onMouseUp: function() {
            var a = this;
            a.fire("mouseup")
        },
        onMouseOver: function(a) {
            var b = this;
            b.fire("mouseover"), b.tip && b.renderTip(a)
        },
        renderTip: function(a) {
            var b = this;
            b.tooltip && b.tooltip.destroy(), b.tooltip = new Fancy.ToolTip({
                text: b.tip
            }), b.tooltip.el.css("display", "block"), b.tooltip.show(a.pageX + 15, a.pageY - 25)
        },
        onMouseOut: function() {
            var a = this;
            a.fire("mouseout"), a.tooltip && (a.tooltip.destroy(), delete a.tooltip)
        },
        setText: function(a) {
            var b = this, c = b.el;
            c.css("width", (parseInt(c.css("font-size")) + 2) * a.length + 2 * parseInt(c.css("padding-right")) + 2), c.select(".fancy-button-text").update(a)
        },
        disable: function() {
            var a = this;
            a.disabled=!0, a.el.addClass(a.disabledCls)
        },
        enable: function() {
            var a = this;
            a.disabled=!1, a.el.removeClass(a.disabledCls)
        },
        onMouseMove: function(a) {
            var b = this;
            b.tip && b.tooltip && b.tooltip.show(a.pageX + 15, a.pageY - 25)
        }
    })
}(), Fancy.define("Fancy.SegButton", {
    extend: Fancy.Widget,
    constructor: function(a, b) {
        var c = this;
        c.scope = b, c.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents(), a.Super("init", arguments), a.style = a.style || {}, a.render(), a.setOns()
    },
    setOns: function() {
        var a = this;
        a.el
    },
    widgetCls: "fancy-seg-button",
    cls: "",
    extraCls: "",
    text: "",
    render: function() {
        var a, b = this, c = Fancy.get(document.createElement("div"));
        b.fire("beforerender"), a = Fancy.get(b.renderTo || document.body).dom, c.addClass(Fancy.cls), c.addClass(b.widgetCls), c.addClass(b.cls), c.addClass(b.extraCls), b.el = Fancy.get(a.appendChild(c.dom)), Fancy.each(b.style, function(a, c) {
            b.el.css(c, a)
        }), b.renderButtons(), b.fire("afterrender"), b.fire("render")
    },
    renderButtons: function() {
        for (var a = this, b = a.items, c = 0, d = b.length, e = Fancy.id(null, "fancy-toggle-group-"); d > c; c++) {
            var f = b[c];
            f.renderTo = a.el.dom, a.allowToggle!==!1 && (f.enableToggle=!0, a.multiToggle!==!0 && (f.toggleGroup = e)), 0 === c ? f.style = {
                "border-right-width": 0,
                "border-top-right-radius": 0,
                "border-bottom-right-radius": 0
            } : c > 1 ? f.style = {
                "border-left-width": 0,
                "border-top-left-radius": 0,
                "border-bottom-left-radius": 0
            } : f.style = {
                "border-top-left-radius": 0,
                "border-bottom-left-radius": 0
            }, b.length > 2 && 0 !== c && c !== d - 1 && Fancy.apply(f.style, {
                "border-top-right-radius": 0,
                "border-bottom-right-radius": 0,
                "border-top-left-radius": 0,
                "border-bottom-left-radius": 0
            }), a.items[c] = new Fancy.Button(f)
        }
    }
}), Fancy.Mixin("Fancy.panel.mixin.PrepareConfig", {
    prepareConfigTheme: function(a, b) {
        var c = a.theme || b.theme, d = Fancy.getTheme(c).config;
        return Fancy.isObject(c) && (a.theme = c.name), Fancy.applyIf(a, d), a
    },
    prepareConfigFooter: function(a) {
        var b = a.footer, c = a.lang;
        if (b) {
            var d = [];
            if (Fancy.isString(b.status) && d.push({
                type: "text",
                text: b.status,
                cls: "fancy-footer-status"
            }), b.status && b.source && d.push("side"), Fancy.isString(b.source))
                d.push({
                    type: "text",
                    text: b.source,
                    cls: "fancy-footer-source"
                });
            else if (Fancy.isObject(b.source)) {
                var e = b.source.text, f = b.source.sourceText || c.sourceText;
                if (b.source.link) {
                    var g = b.source.link;
                    g = g.replace("", ""), g = "" + g, e = '<span class="fancy-status-source-text">' + f + '</span>: <a class="fancy-status-source-link" href="bis.zju.edu.cn">' + e + "</a>"
                } else 
                    e = "<span>" + f + ":</span> " + e;
                d.push({
                    type: "text",
                    text: e,
                    cls: "fancy-footer-source"
                })
            }
            a.footer = d
        }
        return a
    },
    prepareConfigLang: function(a, b) {
        var c = b.i18n || a.i18n, d = Fancy.Object.copy(Fancy.i18n[c]);
        if (a.lang) {
            for (var e in a.lang)
                Fancy.isObject(a.lang[e])===!1 && (d[e] = a.lang[e]);
            d.paging = {}, a.lang.paging && Fancy.apply(d.paging, a.lang.paging);
            for (var e in a.lang.paging)
                "paging" !== e && (Fancy.isObject(e) || (d[e] = a.lang.paging[e]));
            d.date = {}, a.lang.date && Fancy.apply(d.date, a.lang.date)
        }
        return a.lang = d, a
    }
}), Fancy.Mixin("Fancy.panel.mixin.methods", {
    setTitle: function(a) {
        var b = this;
        b.panel && b.panel.setTitle(a)
    },
    getTitle: function() {
        var a = this;
        return a.panel ? a.panel.getTitle() : void 0
    },
    setSubTitle: function(a) {
        var b = this;
        b.panel && b.panel.setSubTitle(a)
    },
    getSubTitle: function() {
        var a = this;
        return a.panel ? a.panel.getSubTitle() : void 0
    }
}), Fancy.Mixin("Fancy.panel.mixin.DD", {
    ddCls: "fancy-panel-draggable",
    initDD: function() {
        var a = this;
        a.widget;
        a.addDDCls(), a.addDD()
    },
    addDDCls: function() {
        var a = this;
        a.el.addClass(a.ddCls)
    },
    addDD: function() {
        var a = this;
        Fancy.DD.add({
            dragEl: a.el,
            overEl: a.el.select(".fancy-panel-header").item(0)
        })
    }
}), Fancy.Mixin("Fancy.panel.mixin.Resize", {
    cornerResizeCls: "fancy-panel-resize-corner",
    resizeMaskCls: "fancy-panel-resize-mask",
    initResize: function() {
        var a = this;
        a.widget;
        a.addEvents("resize"), a.activeResizeEl = void 0, a.renderResizeEls(), a.onsResizeEls()
    },
    renderResizeEls: function() {
        var a = this, b = a.el, c = Fancy.get(document.createElement("div"));
        c.addClass(a.cornerResizeCls), a.cornerResizeEl = Fancy.get(b.dom.appendChild(c.dom))
    },
    onResize: function() {
        var a = this;
        a.tbar && a._tbar.applyScrollChanges(), a.subTBar && a._subTBar.applyScrollChanges(), a.bbar && a._bbar.applyScrollChanges(), a.footer && a._footer.applyScrollChanges(), a.buttons && a._buttons.applyScrollChanges()
    },
    onsResizeEls: function(a) {
        var b = this;
        b.cornerResizeEl.on("mousedown", b.onMouseDownResizeEl, b), b.on("resize", b.onResize, b)
    },
    onMouseDownResizeEl: function(a) {
        var b = this, c = Fancy.get(document);
        a.preventDefault(), c.once("mouseup", b.onMouseUpResize, b), c.on("mousemove", b.onMouseMoveResize, b), b.renderResizeMask(), b.startClientX = a.clientX, b.startClientY = a.clientY
    },
    onMouseUpResize: function() {
        var a = this, b = Fancy.get(document);
        delete a.activeResizeEl, a.resizeMaskEl.destroy(), delete a.startClientX, delete a.startClientY, b.un("mousemove", a.onMouseMoveResize, a), a.setWidth(a.newResizeWidth), a.setHeight(a.newResizeHeight), a.fire("resize", {
            width: a.newResizeWidth,
            height: a.newResizeHeight
        })
    },
    onMouseMoveResize: function(a) {
        var b = this, c = b.el, d = 2, e = (parseInt(c.css("width")) - 2 * d, parseInt(c.css("height")) - 2 * d, a.clientX), f = a.clientY, g = b.startClientX - e, h = b.startClientY - f, i = b.startResizeWidth - g, j = b.startResizeHeight - h;
        a.preventDefault(), a.stopPropagation(), i < b.minWidth && (i = b.minWidth), j < b.minHeight && (j = b.minHeight), b.newResizeWidth = i, b.newResizeHeight = j, b.resizeMaskEl.css({
            width: i,
            height: j
        })
    },
    renderResizeMask: function() {
        var a = this, b = a.el, c = 2, d = Fancy.get(document.createElement("div")), e = parseInt(b.css("top")), f = parseInt(b.css("left")), g = parseInt(b.css("width")) - 2 * c, h = parseInt(b.css("height")) - 2 * c, i = parseInt(b.css("z-index"));
        if (a.startResizeWidth = g, a.startResizeHeight = h, !a.window && "absolute" !== b.css("position")) {
            var j = b.offset();
            e = j.top, f = j.left
        }
        d.addClass(a.resizeMaskCls), d.css({
            left: f,
            top: e,
            width: g,
            height: h,
            "z-index": i
        }), a.resizeMaskEl = Fancy.get(document.body.appendChild(d.dom))
    }
}), Fancy.define("Fancy.Panel", {
    extend: Fancy.Widget,
    mixins: ["Fancy.panel.mixin.DD", "Fancy.panel.mixin.Resize"],
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.Super("constructor", arguments)
    },
    init: function() {
        var a = this;
        a.Super("init", arguments), a.initTpl(), a.render(), a.draggable && a.initDD(), a.resizable && a.initResize()
    },
    cls: "fancy fancy-panel",
    value: "",
    width: 300,
    height: 200,
    titleHeight: 30,
    subTitleHeight: 30,
    barHeight: 37,
    title: void 0,
    frame: !0,
    shadow: !0,
    draggable: !1,
    minWidth: 200,
    minHeight: 200,
    barContainer: !0,
    tpl: ['<div style="height:{titleHeight}px;" class="fancy-panel-header fancy-display-none">',
    '<div class="fancy-panel-header-text">{title}</div>',
    '<div class="fancy-panel-header-tools"></div>',
    "</div>",
    '<div style="height:{subTitleHeight}px;" class="fancy-panel-sub-header fancy-display-none">',
    '<div class="fancy-panel-sub-header-text">{subTitle}</div>',
    "</div>",
    '<div class="fancy-panel-body">',
    '<div class="fancy-panel-tbar fancy-display-none" style="height:{barHeight}px;"></div>',
    '<div class="fancy-panel-sub-tbar fancy-display-none" style="height:{barHeight}px;"></div>',
    '<div class="fancy-panel-body-inner"></div>',
    '<div class="fancy-panel-bbar fancy-display-none" style="height:{barHeight}px;"></div>',
    '<div class="fancy-panel-buttons fancy-display-none" style="height:{barHeight}px;"></div>',
    '<div class="fancy-panel-footer fancy-display-none" style="height:{barHeight}px;"></div>',
    "</div>"],
    render: function() {
        var a = this,
        b = Fancy.get(a.renderTo || document.body),
        c = Fancy.get(document.createElement("div")),
        d = 0,
        e = a.titleHeight,
        f = a.subTitleHeight,
        g = "fancy-display-none";
        a.window===!0 && c.css({
            display: "none",
            position: "absolute"
        }), a.frame===!1 && c.addClass("fancy-panel-noframe"), c.addClass(a.cls), "default" !== a.theme && c.addClass("fancy-theme-" + a.theme), a.shadow && c.addClass("fancy-panel-shadow"), c.css({
            width: a.width + "px",
            height: a.height - d + "px"
        }), a.style && c.css(a.style);
        var h = "", i = "";
        Fancy.isObject(a.title) ? h = a.title.text : Fancy.isString(a.title) && (h = a.title), Fancy.isObject(a.subTitle) ? i = a.subTitle.text : Fancy.isString(a.subTitle) && (i = a.subTitle), c.update(a.tpl.getHTML({
            barHeight: a.barHeight,
            titleHeight: e,
            subTitleHeight: f,
            title: h,
            subTitle: i
        })), Fancy.isObject(a.title) && (a.title.style && c.select(".fancy-panel-header").css(a.title.style), a.title.cls && c.select(".fancy-panel-header").addClass(a.title.cls), a.title.tools && (a.tools = a.title.tools)), Fancy.isObject(a.subTitle) && (a.subTitle.style && c.select(".fancy-panel-sub-header").css(a.subTitle.style), a.subTitle.cls && c.select(".fancy-panel-sub-header").addClass(a.subTitle.cls)), a.title ? c.select(".fancy-panel-header").removeClass(g) : c.select(".fancy-panel-body").css("border-top-width", "0px"), a.subTitle && (c.select(".fancy-panel-body").css("border-top-width", "0px"), c.select(".fancy-panel-sub-header").removeClass(g)), a.tbar && c.select(".fancy-panel-tbar").removeClass(g), a.subTBar && c.select(".fancy-panel-sub-tbar").removeClass(g), a.bbar && c.select(".fancy-panel-bbar").removeClass(g), a.buttons && c.select(".fancy-panel-buttons").removeClass(g), a.footer && c.select(".fancy-panel-footer").removeClass(g), a.el = b.dom.appendChild(c.dom), a.el = Fancy.get(a.el), a.modal && 0 === Fancy.select("fancy-modal").length && Fancy.get(document.body).append('<div class="fancy-modal" style="display: none;"></div>'), a.renderTools(), a.renderBars()
    }, renderTools: function() {
        var a = this, b = a.tools;
        if (void 0 !== b)
            for (var c = 0, d = b.length; d > c; c++)
                a.tools[c].renderTo = a.el.select(".fancy-panel-header-tools").dom, a.tools[c] = new Fancy.Tool(a.tools[c], a.scope || a)
    }, initTpl: function() {
        var a = this;
        a.tpl = new Fancy.Template(a.tpl)
    }, renderBars: function() {
        var a = this, b=!1;
        a.items && a.items[0] && "grid" === a.items[0].type && (b=!0), a.bbar && (a._bbar = new Fancy.Bar({
            el: a.el.select(".fancy-panel-bbar"),
            items: a.bbar,
            height: a.barHeight,
            barContainer: a.barContainer,
            scope: this.items[0]
        }), a.bbar = a._bbar.items), a.buttons && (a._buttons = new Fancy.Bar({
            el: a.el.select(".fancy-panel-buttons"),
            items: a.buttons,
            height: a.barHeight,
            scope: this.items[0]
        }), a.buttons = a._buttons.items), a.tbar && (a._tbar = new Fancy.Bar({
            el: a.el.select(".fancy-panel-tbar"),
            items: a.tbar,
            height: a.barHeight,
            tabEdit: !a.subTBar && b,
            scope: this.items[0]
        }), a.tbar = a._tbar.items), a.subTBar && (a._subTBar = new Fancy.Bar({
            el: a.el.select(".fancy-panel-sub-tbar"),
            items: a.subTBar,
            height: a.barHeight,
            tabEdit: b,
            scope: this.items[0]
        }), a.subTBar = a._subTBar.items), a.footer && (a._footer = new Fancy.Bar({
            el: a.el.select(".fancy-panel-footer"),
            items: a.footer,
            height: a.barHeight,
            scope: this.items[0]
        }), a.footer = a._footer.items)
    }, showAt: function(a, b) {
        var c = this;
        c.el.css({
            left: a + "px",
            display: "",
            "z-index": 1e3 + Fancy.zIndex++
        }), void 0 !== b && c.el.css({
            top: b + "px"
        })
    }, show: function() {
        var a = this;
        if (a.el.show(), a.window===!0) {
            var b = Fancy.getViewSize(), c = a.el.height(), d = a.el.width(), e = [], f = Fancy.getScroll(), g = f[0], h = f[1];
            e[0] = (b[1] - d) / 2, e[1] = (b[0] - c) / 2, e[0] < 10 && (e[0] = 10), e[1] < 10 && (e[1] = 10), a.el.css({
                left: e[0] + h + "px",
                top: e[1] + g + "px",
                display: "",
                "z-index": 1e3 + Fancy.zIndex++
            }), Fancy.select(".fancy-modal").css("display", "")
        }
    }, hide: function() {
        var a = this;
        a.el.css({
            display: "none"
        }), Fancy.select(".fancy-modal").css("display", "none");
        for (var b = a.items || [], c = 0, d = b.length; d > c; c++)
            "combo" === a.items[c].type && a.items[c].hideList()
    }, setTitle: function(a) {
        var b = this;
        b.el.select(".fancy-panel-header-text").update(a)
    }, getTitle: function(a) {
        var b = this;
        return b.el.select(".fancy-panel-header-text").dom.innerHTML
    }, setSubTitle: function(a) {
        var b = this;
        b.el.select(".fancy-panel-sub-header-text").update(a)
    }, getSubTitle: function(a) {
        var b = this;
        return b.el.select(".fancy-panel-sub-header-text").dom.innerHTML
    }, getHeight: function() {
        var a = this;
        return parseInt(a.el.css("height"))
    }, setWidth: function(a) {
        var b = this;
        return void b.items[0].setWidth(a)
    }, setHeight: function(a) {
        var b = this;
        b.el.css("height", a), b.items[0].setHeight(a)
    }
}), Fancy.define("Fancy.Tool", {
    extend: Fancy.Widget,
    constructor: function(a, b) {
        var c = this;
        c.scope = b, c.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("click", "mousedown", "mouseup", "mouseover", "mouseout"), a.Super("init", arguments), a.style = a.style || {}, a.render(), a.setOns()
    },
    setOns: function() {
        var a = this, b = a.el;
        b.on("click", a.onClick, a)
    },
    cls: "fancy fancy-button",
    text: "",
    height: 28,
    paddingTextWidth: 5,
    render: function() {
        var a = this, b = Fancy.get(a.renderTo || document.body).dom, c = document.createElement("div");
        a.fire("beforerender"), c.className = "fancy-tool-button", c.innerHTML = a.text, a.el = Fancy.get(b.appendChild(c)), a.fire("afterrender"), a.fire("render")
    },
    onClick: function() {
        var a = this;
        a.fire("click"), a.handler && (a.scope ? a.handler.apply(a.scope, [a]) : a.handler(a))
    },
    setText: function(a) {
        var b = this;
        b.el.update(a)
    }
}), Fancy.define("Fancy.Bar", {
    extend: Fancy.Widget,
    widgetCls: "fancy-bar",
    containerCls: "fancy-bar-container",
    cls: "",
    text: "",
    floating: "left",
    sideRight: 0,
    scrolled: 0,
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.init()
    },
    init: function() {
        var a = this;
        a.roles = {}, a.render(), a.initScroll(), a.checkScroll()
    },
    render: function() {
        var a = this;
        a.renderEl(), a.renderItems(), a.initTabEdit()
    },
    renderEl: function() {
        var a = this;
        if (!a.el) {
            var b = Fancy.get(document.createElement("div"));
            b.addClass(a.widgetCls), b.addClass(a.cls), b.update(a.text), a.el = Fancy.get(a.renderTo.appendChild(b.dom)), a.style && a.el.css(a.style)
        }
        var c = Fancy.get(document.createElement("div"));
        c.addClass(a.containerCls), a.containerEl = Fancy.get(a.el.dom.appendChild(c.dom))
    },
    renderItems: function() {
        for (var a = this, b = (a.el, a.containerEl), c = a.items || [], d = 0, e = c.length, f=!1, g = [], h = e - 1; e > d; d++) {
            var i = c[d];
            switch (f && (i = c[h], h--), i.toggleGroup && (i.enableToggle=!0), Fancy.isObject(i) && (i.type = i.type || "button"), f && (a.floating = "right"), i.renderTo = b.dom, i) {
            case"|":
                var j = {
                    "float": a.floating,
                    "margin-right": "5px",
                    "margin-top": "6px",
                    "padding-left": "0px"
                };
                "right" === a.floating && Fancy.applyIf(j, {
                    right: "1px",
                    position: "absolute"
                }), g.push(new Fancy.Separator({
                    renderTo: b.dom,
                    style: j
                }));
                continue;
            case"side":
                f=!0;
                continue;
            default:
                f ? g[h] = a.renderItem(i) : g.push(a.renderItem(i))
            }
        }
        a.items = g
    },
    renderItem: function(a) {
        var b, c = this, d = (c.el, c.containerEl);
        switch (a.style = a.style || {}, a.label=!1, a.padding=!1, Fancy.applyIf(a.style, {
            "float": c.floating
        }), "right" === c.floating && Fancy.applyIf(a.style, {
            right: c.sideRight,
            position: "absolute"
        }), !a.scope && c.items && (a.scope = c.items[0]), a.type) {
        case"wrapper":
            "fancy-month-picker-action-buttons" === a.cls && (d.destroy(), d = c.el);
            for (var e, f = d.append('<div class="' + (a.cls || "") + '"></div>').select("div").item(0), g = 0, h = a.items.length, i = 0; h > g; g++) {
                e = a.items[g], Fancy.isObject(e) && (e.type = e.type || "button"), e.renderTo = f.dom, b = c.renderItem(e);
                var j = b.el;
                g === h - 1 ? j.css("margin-right", "0px") : i += parseInt(j.css("margin-right")), Fancy.nojQuery ? (i += parseInt(j.width()), i += parseInt(j.css("margin-left"))) : i += parseInt(j.$dom.outerWidth())
            }
            f.css("width", i);
            break;
        case void 0:
        case"button":
            a.extraCls = "fancy-bar-button", a.scope = c.scope, b = new Fancy.Button(a);
            break;
        case"segbutton":
            a.extraCls = "fancy-bar-seg-button", b = new Fancy.SegButton(a);
            break;
        case"tab":
            isTab=!0, b = new Fancy.toolbar.Tab(a);
            break;
        case"text":
            Fancy.applyIf(a.style, {
                "margin-right": "10px",
                "padding-left": "0px",
                "padding-top": "11px"
            }), Fancy.apply(a, {
                renderTo: d.dom,
                cls: a.cls || ""
            }), b = new Fancy.bar.Text(a);
            break;
        case"combo":
            a.inputWidth = 18, Fancy.applyIf(a.style, {
                "padding-left": "0px",
                "margin-right": "8px",
                "margin-top": "4px"
            }), Fancy.applyIf(a, {
                width: 70
            }), b = new Fancy.Combo(a);
            break;
        case"date":
            a.inputWidth = 18, Fancy.applyIf(a.style, {
                "padding-left": "0px",
                "margin-right": "8px",
                "margin-top": "4px"
            }), Fancy.applyIf(a, {
                width: 100
            }), b = new Fancy.DateField(a);
            break;
        case"number":
            a.inputWidth = 18, Fancy.applyIf(a.style, {
                "padding-left": "0px",
                "margin-right": "8px",
                "margin-top": "4px"
            }), Fancy.applyIf(a, {
                width: 35
            }), b = new Fancy.NumberField(a);
            break;
        case"string":
            a.inputWidth = 18, Fancy.applyIf(a.style, {
                "padding-left": "0px",
                "margin-right": "8px",
                "margin-top": "4px"
            }), Fancy.applyIf(a, {
                width: 100
            }), b = new Fancy.StringField(a);
            break;
        case"search":
            a.inputWidth = 18, a.events = a.events || [], a.events = a.events.concat([{
                enter: function(a, b) {
                    var c = Fancy.getWidget(a.el.parent().parent().parent().parent().select(".fancy-grid").attr("id"));
                    c.search(b)
                }
            }, {
                key: function(a, b) {
                    var c = this, d = Fancy.getWidget(a.el.parent().parent().parent().parent().select(".fancy-grid").attr("id"));
                    c.autoEnterTime || (c.autoEnterTime = new Date), c.intervalAutoEnter && clearInterval(c.intervalAutoEnter), delete c.intervalAutoEnter, c.intervalAutoEnter = setInterval(function() {
                        var e = new Date;
                        e - c.autoEnterTime > 500 && (clearInterval(c.intervalAutoEnter), delete c.intervalAutoEnter, b = a.getValue(), d.search(b))
                    }, 200)
                }
            }, {
                render: function(a) {
                    var b = this;
                    a.el.on("mousedown", function(a) {
                        a.preventDefault()
                    }, null, ".fancy-field-search-params-link"), a.el.on("click", function(c) {
                        for (var d=!1, e = Fancy.getWidget(a.el.parent().parent().parent().parent().select(".fancy-grid").attr("id")), f = e.columns || [], g = e.leftColumns || [], h = e.rightColumns || [], i = f.concat(g).concat(h), j = [], k = 0, l = i.length, m = 1; l > k; k++) {
                            var n = i[k];
                            n.searchable!==!1 && (m += e.fieldHeight, j.push({
                                inputLabel: " &nbsp;&nbsp;" + n.title,
                                value: !0,
                                name: n.index
                            }))
                        }
                        if (b.list) {
                            if ("none" !== b.list.el.css("display"))
                                return void b.list.el.css("display", "none");
                            d=!0
                        } else 
                            b.list = new FancyForm({
                                width: 150,
                                height: m,
                                defaults: {
                                    type: "checkbox",
                                    label: !1,
                                    style: {
                                        padding: "8px 16px 0px"
                                    }
                                },
                                items: j,
                                cls: "fancy-field-search-list",
                                events: [{
                                    set: function(a, c) {
                                        e.search.setKeys(b.list.get())
                                    }
                                }
                                ]
                            });
                        var o = Fancy.get(c.target), p = o.offset();
                        b.list.el.css({
                            position: "absolute",
                            top: p.top + p.height + 20,
                            left: p.left
                        }), d && b.list.el.css("display", "block"), b.list.el.animate({
                            duration: 200,
                            top: p.top + p.height + 3
                        })
                    }, null, ".fancy-field-search-params-link")
                }
            }
            ]), Fancy.applyIf(a.style, {
                "float": c.floating,
                "padding-left": "0px",
                "margin-right": "8px",
                "margin-top": "4px"
            });
            var k = "fancy-field-search";
            a.paramsMenu && (a.tpl = ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', '<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">', '<div class="fancy-field-error" style="{errorTextStyle}"></div>', '<div class="fancy-field-search-params-link" style="">Parameters</div>', "</div>", '<div class="fancy-clearfix"></div>'], k += " fancy-field-search-paramed"), Fancy.applyIf(a, {
                padding: !1,
                width: 250,
                cls: k,
                emptyText: "Search"
            }), b = new Fancy.StringField(a)
        }
        return "right" === c.floating && (c.sideRight += b.el.width(), c.sideRight += parseInt(b.el.css("margin-right")), c.sideRight += 7), a.role && (c.roles[a.role] = b), b
    },
    initScroll: function() {
        var a = this;
        a.leftScroller = new Fancy.Button({
            imageCls: "fancy-bar-left-scroller",
            renderTo: a.el.dom,
            cls: "fancy-bar-left-scroller",
            height: a.height + 2,
            minWidth: 20,
            paddingTextWidth: 0,
            imageWidth: 20,
            width: 0,
            text: !1,
            id: "my",
            style: {
                position: "absolute",
                left: - 2,
                top: - 1,
                display: "none"
            },
            listeners: [{
                click: a.onPrevScrollClick,
                scope: a
            }
            ]
        }), a.rightScroller = new Fancy.Button({
            imageCls: "fancy-bar-right-scroller",
            renderTo: a.el.dom,
            cls: "fancy-bar-right-scroller",
            height: a.height + 2,
            minWidth: 20,
            paddingTextWidth: 0,
            imageWidth: 20,
            width: 0,
            text: !1,
            style: {
                position: "absolute",
                right: - 2,
                top: - 1,
                display: "none"
            },
            listeners: [{
                click: a.onNextScrollClick,
                scope: a
            }
            ]
        })
    },
    getBarWidth: function() {
        var a = this;
        return a.el.width()
    },
    getItemsWidth: function() {
        for (var a = this, b = 0, c = a.items.length, d = 0; c > b; b++) {
            var e = a.items[b];
            d += e.el.width(), d += parseInt(e.el.css("margin-left")), d += parseInt(e.el.css("margin-right"))
        }
        return d
    },
    onPrevScrollClick: function() {
        var a = this;
        a.scrolled += 30, a.applyScrollChanges()
    },
    onNextScrollClick: function() {
        var a = this;
        a.scrolled -= 30, a.applyScrollChanges()
    },
    applyScrollChanges: function() {
        var a = this, b = a.getItemsWidth(), c = a.getBarWidth(), d = b - c;
        return c > b ? (a.scrolled = 0, a.leftScroller.el.hide(), a.rightScroller.el.hide(), void a.containerEl.css("margin-left", "0px")) : (a.scrolled > 0 ? (a.scrolled = 0, a.leftScroller.disable(), a.rightScroller.enable()) : a.scrolled<-d && (a.scrolled =- d, a.leftScroller.enable(), a.rightScroller.disable()), a.leftScroller.el.show(), a.rightScroller.el.show(), void a.containerEl.css("margin-left", a.scrolled + a.leftScroller.el.width() + "px"))
    },
    onDocMouseUp: function() {
        var a = this;
        a.scrollInterval && (clearTimeout(a.scrollInterval), delete a.scrollInterval)
    },
    checkScroll: function() {
        var a = this, b = a.getItemsWidth(), c = a.getBarWidth();
        b > c && a.enableScroll()
    },
    enableScroll: function() {
        var a = this;
        a.leftScroller.el.show(), a.rightScroller.el.show(), 0 === a.scrolled && (a.leftScroller.disable(), a.containerEl.css("margin-left", a.leftScroller.el.width() + "px"))
    },
    initTabEdit: function() {
        var a = this;
        if (a.tabEdit)
            for (var b = a.items.length - 1; b>-1; b--) {
                var c = a.items[b];
                switch (c.type) {
                case"number":
                case"string":
                case"date":
                    return void c.on("tab", a.onTabLastInput, a)
                }
            }
        },
    onTabLastInput: function(a, b) {
        var c = this, d = Fancy.getWidget(c.el.parent().select(".fancy-grid").attr("id"));
        b.preventDefault(), d.leftColumns.length ? setTimeout(function() {
            d.leftBody.el.select(".fancy-grid-cell").item(0).dom.click()
        }, 100) : setTimeout(function() {
            d.body.el.select(".fancy-grid-cell").item(0).dom.click()
        }, 100)
    }
}), Fancy.define("Fancy.Separator", {
    cls: "fancy-separator",
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.init()
    },
    init: function() {
        var a = this;
        a.render()
    },
    render: function() {
        var a = this, b = Fancy.get(document.createElement("div"));
        b.addClass(a.cls), b.update("<div></div>"), a.el = Fancy.get(a.renderTo.appendChild(b.dom)), a.style && a.el.css(a.style)
    }
}), Fancy.define("Fancy.bar.Text", {
    widgetCls: "fancy-bar-text",
    cls: "",
    text: "",
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.init()
    },
    init: function() {
        var a = this;
        a.render()
    },
    render: function() {
        var a = this, b = Fancy.get(document.createElement("div"));
        b.addClass(a.widgetCls), b.addClass(a.cls), b.update(a.text), a.el = Fancy.get(a.renderTo.appendChild(b.dom)), a.style && a.el.css(a.style)
    }
}), Fancy.define("Fancy.Form", {
    extend: Fancy.Widget,
    mixins: ["Fancy.form.mixin.Form", Fancy.panel.mixin.PrepareConfig, Fancy.panel.mixin.methods, "Fancy.form.mixin.PrepareConfig"],
    type: "form",
    theme: "default",
    i18n: "en",
    maxLabelNumber: 11,
    minWidth: 200,
    minHeight: 200,
    constructor: function(a) {
        var b = this, a = a || {}, c = function(c) {
            c && Fancy.apply(a, c), a = b.prepareConfig(a, b), Fancy.applyConfig(b, a), b.Super("const", arguments)
        }, d = function() {
            var d = a.i18n || b.i18n;
            Fancy.loadLang(d, c)===!0 && c({})
        };
        Fancy.modules.form || Fancy.fullBuilt || Fancy.MODULELOAD===!1 ? d() : Fancy.loadModule("form", function() {
            d()
        })
    }
});
var FancyForm = Fancy.Form;
FancyForm.get = function(a) {
    var b = Fancy.get(a).select(".fancy-form").dom.id;
    return Fancy.getWidget(b)
}, FancyForm.defineTheme = Fancy.defineTheme, FancyForm.defineController = Fancy.defineController, FancyForm.addValid = Fancy.addValid, Fancy.nojQuery || Fancy.$ || (Fancy.$.fn.FancyForm = function(a) {
    return a.renderTo = $(this.selector)[0].id, new Fancy.Form(a)
}), Fancy.ns("Fancy.form.field"), Fancy.form.field.Mixin = function() {}, Fancy.form.field.Mixin.prototype = {
    padding: "8px 8px 0px 8px",
    inputHeight: 29,
    labelHeight: 18,
    failedValidCls: "fancy-field-not-valid",
    cls: "",
    ons: function() {
        var a = this, b = a.el, c = a.el.getByTag("input");
        a.input = c, c.on("blur", a.onBlur, a), c.on("focus", a.onFocus, a), c.on("input", a.onInput, a), c.on("keydown", a.onKeyDown, a), b.on("mouseover", a.onMouseOver, a), b.on("mouseout", a.onMouseOut, a), a.on("key", a.onKey, a), a.tip && b.on("mousemove", a.onMouseMove, a), a.format && a.format.inputFn && (void 0 !== a.value && a.formatValue(a.value), a.on("key", a.onKeyInputFn))
    },
    onKeyInputFn: function(a, b, c) {
        var d = c.keyCode, e = Fancy.key;
        switch (d) {
        case e.ENTER:
        case e.ESC:
        case e.LEFT:
        case e.RIGHT:
            return 
        }
        this.formatValue(b)
    },
    formatValue: function(a) {
        var b = this;
        a = b.format.inputFn(a), b.input.dom.value = a
    },
    onMouseOver: function(a) {
        var b = this;
        b.fire("mouseover"), b.tip && b.renderTip(a)
    },
    onMouseOut: function(a) {
        var b = this;
        b.fire("mouseout"), b.tip && b.tooltip && (b.tooltipToDestroy=!0, b.tooltip.destroy(), delete b.tooltip)
    },
    render: function() {
        var a = this, b = a.renderTo || document.body, c = Fancy.get(document.createElement("div"));
        a.style;
        Fancy.isString(b) && (b = document.getElementById(b), b || (b = Fancy.select(b).item(0))), a.fire("beforerender"), c.addClass(a.cls), c.addClass(a.fieldCls), c.attr("id", a.id);
        var d = "", e = "";
        a.itemsHTML && (e = a.itemsHTML), "top" === a.labelAlign && a.label && a.labelWidth < 7 * a.label.length && (a.labelWidth = 7 * (a.label.length + 2)), a.labelWidth && (d = "width:" + a.labelWidth + "px;");
        var f = a.label;
        "" === a.label ? f = "&nbsp;" : void 0 === a.label ? f = "&nbsp;" : "right" !== a.labelAlign && (f += ":");
        var g = "", h = "", i = "";
        if (a.label===!1 && (g = "display:none;"), a.inputLabel ? i = a.inputLabel : h = "display:none;", "recaptcha" === a.type ? c.update(a.tpl.getHTML({
            key: a.key
        })) : c.update(a.tpl.getHTML({
            labelWidth: d,
            label: f,
            labelDisplay: g,
            inputLabelDisplay: h,
            inputLabel: i,
            emptyText: a.emptyText,
            value: a.value,
            height: a.height,
            itemsHTML: e,
            errorTextStyle: "",
            buttonText: a.buttonText
        })), a.el = c, a.setStyle(), a.renderId===!0 && c.attr("id", a.id), b.appendChild(c.dom), a.el = c, "textarea" === a.type ? a.input = a.el.getByTag("textarea") : a.input = a.el.getByTag("input"), a.name && (a.input.name = a.name), a.setSize(), "top" === a.labelAlign)
            a.el.addClass("fancy-field-label-align-top"), a.el.select(".fancy-field-text").css("float", "none");
        else if ("right" === a.labelAlign)
            switch (a.el.addClass("fancy-field-label-align-right"), a.type) {
            case"radio":
                $(c.dom).find(".fancy-field-label").insertAfter($(c.dom).find(".fancy-field-text:last"));
                break;
            case"textarea":
                $(c.dom).find(".fancy-field-label").insertAfter($(c.dom).find(".fancy-textarea-text"));
                break;
            default:
                $(c.dom).find(".fancy-field-label").insertAfter($(c.dom).find(".fancy-field-text"))
            } else 
                "radio" !== a.type;
        a.acceptedValue = a.value, a.fire("afterrender"), a.fire("render"), "recaptcha" !== a.type && "chat" !== a.type && setTimeout(function() {
            a.input && a.input.dom && 0 === a.input.dom.value.length && (void 0 === a.prevColor && (a.prevColor = a.input.css("color")), a.input.css("color", "grey"))
        }, 1)
    },
    onKeyDown: function(a) {
        var b = this, c = a.keyCode, d = Fancy.key;
        if ("number" === b.type && Fancy.Key.isNumControl(c, a)===!1)
            return a.preventDefault(), void a.stopPropagation();
        switch (c) {
        case d.TAB:
            b.fire("tab", a);
            break;
        case d.ENTER:
            b.fire("enter", b.getValue()), "textarea" !== b.type && (a.preventDefault(), a.stopPropagation());
            break;
        case d.UP:
            "number" === b.type && b.spinUp(), b.fire("up", b.getValue()), "textarea" !== b.type && (a.preventDefault(), a.stopPropagation());
            break;
        case d.DOWN:
            "number" === b.type && b.spinDown(), b.fire("up", b.getValue()), "textarea" !== b.type && (a.preventDefault(), a.stopPropagation());
            break;
        case d.LEFT:
            break;
        case d.RIGHT:
            a.stopPropagation();
            break;
        default:
            setTimeout(function() {
                b.input && (0 === b.input.dom.value.length ? (void 0 === b.prevColor && (b.prevColor = b.input.css("color")), b.input.css("color", "grey")) : b.prevColor ? b.input.css("color", b.prevColor) : b.input.css("color", " "))
            }, 1)
        }
        setTimeout(function() {
            b.fire("key", b.input.dom.value, a)
        }, 1)
    },
    onKey: function(a, b) {
        a.validate(b)
    },
    onBlur: function() {
        var a = this;
        a.fire("blur")
    },
    validate: function(a) {
        var b = this, c = b.vtype;
        if (void 0 === c);
        else {
            var d = Fancy.isValid(c, a);
            d!==!0 ? (b.errorText = new Fancy.Template(d.text).getHTML(d), b.failedValid()) : b.successValid()
        }
    },
    isValid: function() {
        var a = this;
        return !a.el.hasClass(a.failedValidCls)
    },
    onFocus: function() {
        var a = this;
        a.fire("focus")
    },
    onInput: function() {
        var a = this, b = (a.input, a.getValue()), c = a.acceptedValue;
        a.acceptedValue = a.get(), a.fire("input", b), a.fire("change", b, c)
    },
    get: function() {
        var a = this;
        return a.format ? a.value : a.input.dom.value
    },
    getValue: function() {
        return this.get()
    },
    set: function(a, b) {
        var c = this;
        c.value = a, c.format && c.format.inputFn ? c.formatValue(a) : c.input.dom.value = a, b!==!1 && c.onInput(), c.validate(a)
    },
    setValue: function(a, b) {
        this.set(a, b)
    },
    clear: function() {
        this.set("")
    },
    failedValid: function() {
        var a = this, b = a.el;
        b.hasClass(a.failedValidCls) ? a.tooltip && a.errorText && a.tooltip.update(a.errorText) : (!a.tooltip && a.errorText && (a.showErrorTip(), a.el.on("mousemove", a.onMouseMove, a), a.input.hover(function(b) {
            a.errorText && (a.showErrorTip(), a.tooltip.show(b.pageX + 15, b.pageY - 25))
        }, function() {
            a.hideErrorTip()
        })), b.addClass(a.failedValidCls))
    },
    successValid: function() {
        var a = this, b = a.el;
        b.removeClass(a.failedValidCls), a.hideErrorTip(), delete a.errorText
    },
    showErrorTip: function() {
        var a = this;
        a.tooltip || (a.tooltip = new Fancy.ToolTip({
            text: a.errorText
        }))
    },
    hideErrorTip: function() {
        var a = this;
        a.tooltip && (a.tooltip.destroy(), delete a.tooltip)
    },
    setInputSize: function(a) {
        var b = this;
        a.width && b.input.css("width", a.width), a.height && b.input.css("height", a.height)
    },
    focus: function() {
        var a = this;
        a.input.focus(), setTimeout(function() {
            a.input.dom.selectionStart = a.input.dom.selectionEnd = 1e4
        }, 0)
    },
    hide: function() {
        var a = this;
        a.fire("beforehide"), a.el.css("display", "none"), a.fire("hide")
    },
    show: function() {
        var a = this;
        a.el.css("display", "block")
    },
    setSize: function(a, b) {
        var c = this;
        if ("set" !== c.type) {
            if (void 0 === a && void 0 === b)
                a = c.width, b = c.height;
            else if (void 0 === b) {
                var d = a;
                a = d.width ? d.width : c.width, b = d.height ? d.height : c.height
            }
            if (c.size)
                return void c.size({
                width: a,
                height: b
            });
            void 0 !== a && c.el.css("width", a), "top" === c.labelAlign ? c.el.css("height", 1.5 * b) : c.el.css("height", b), c.setInputSize({
                width: c.inputWidth,
                height: c.inputHeight
            })
        }
    },
    setStyle: function() {
        var a = this, b = a.style || {}, c = a.padding;
        c ? (Fancy.isNumber(c) ? c += "px" : Fancy.isString(c), void 0 === b.padding && (b.padding = c)) : b.padding = "0px", a.el.css(b)
    },
    preRender: function() {
        var a = this;
        a.tpl && Fancy.isObject(a.tpl)===!1 && (a.tpl = new Fancy.Template(a.tpl)), a.calcSize()
    },
    calcSize: function() {
        var a, b, c, d, e = this, f = e.inputWidth, g = e.padding;
        if (Fancy.isString(g))
            switch (g = g.replace(/px/g, ""), g = g.split(" "), g.length) {
            case 1:
                a = Number(g[0]), g = [a, a, a, a];
                break;
            case 2:
                b = Number(g[0]), c = Number(g[1]), g = [b, c, b, c];
                break;
            case 3:
                b = Number(g[0]), c = Number(g[1]), d = Number(g[2]), g = [b, c, d, b];
                break;
            case 4:
                g = [Number(g[0]), Number(g[1]), Number(g[2]), Number(g[3])]
            } else 
                Fancy.isNumber(g) ? g = [g, g, g, g] : g===!1 && (g = [0, 0, 0, 0]);
        "top" === e.labelAlign && (e.height*=1.5), f = e.width, "top" !== e.labelAlign && e.label && (f -= e.labelWidth), e.height === e.inputHeight && e.padding!==!1 && (e.inputHeight -= g[0] + g[2]), e.inputWidth = f - g[1] - g[3], e.height = e.inputHeight + g[0] + g[2]
    },
    setWidth: function(a) {
        var b = this;
        b.width = a, b.calcSize(), b.el.css("width", a), b.setInputSize({
            width: b.inputWidth
        })
    },
    onMouseMove: function(a) {
        var b = this;
        delete b.tooltipToDestroy, b.tip ? b.renderTip(a) : b.tooltip && b.tooltip.show(a.pageX + 15, a.pageY - 25)
    },
    renderTip: function(a) {
        var b = this, c = "", d = new Fancy.Template(b.tip || b.tooltip);
        b.getValue && (c = b.getValue());
        var e = d.getHTML({
            value: c
        });
        b.tooltip ? b.tooltip.update(e) : b.tooltip = new Fancy.ToolTip({
            text: e
        }), b.tooltip.show(a.pageX + 15, a.pageY - 25)
    }
}, Fancy.define(["Fancy.form.field.String", "Fancy.StringField"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.string",
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "enter", "up", "down", "tab", "change", "key"), a.Super("init", arguments), a.preRender(), a.render(), a.ons(), a.isPassword && a.input.attr({
            type: "password"
        }), a.hidden && a.el.css("display", "none"), a.style && a.el.css(a.style)
    },
    fieldCls: "fancy fancy-field",
    value: "",
    width: 100,
    emptyText: "",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', '<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">', '<div class="fancy-field-error" style="{errorTextStyle}"></div>', "</div>", '<div class="fancy-clearfix"></div>']
}), Fancy.define(["Fancy.form.field.Number", "Fancy.NumberField"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.number",
    allowBlank: !0,
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "enter", "up", "down", "tab", "change", "key"), a.Super("init", arguments), a.preRender(), a.render(), a.ons(), a.hidden && a.el.css("display", "none"), a.initSpin()
    },
    fieldCls: "fancy fancy-field",
    value: "",
    width: 100,
    emptyText: "",
    step: 1,
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', '<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">', '<div class="fancy-field-spin">', '<div class="fancy-field-spin-up"></div>', '<div class="fancy-field-spin-down"></div>', "</div>", '<div class="fancy-field-error" style="{errorTextStyle}"></div>', "</div>", '<div class="fancy-clearfix"></div>'],
    onInput: function() {
        var a = this, b = (a.input, a.get()), c = a.acceptedValue;
        a.acceptedValue = a.get(), a.fire("input", b), a.fire("change", b, c)
    },
    isNumber: function(a) {
        return "" === a || "-" === a?!0 : Fancy.isNumber( + a)
    },
    checkMinMax: function(a) {
        if ("" === a || "-" === a)
            return !0;
        var b = this, a =+ a;
        return a >= b.min && a <= b.max
    },
    setMin: function(a) {
        var b = this;
        b.min = a
    },
    setMax: function(a) {
        var b = this;
        b.max = a
    },
    initSpin: function() {
        var a = this;
        a.spin===!0 && (a.el.select(".fancy-field-spin").css("display", "block"), a.el.select(".fancy-field-spin-up").on("mousedown", a.onMouseDownSpinUp, a), a.el.select(".fancy-field-spin-down").on("mousedown", a.onMouseDownSpinDown, a))
    },
    onMouseDownSpinUp: function() {
        var a = this, b = Fancy.get(document), c = 700, d = new Date;
        a.spinUp(), a.spinInterval = setInterval(function() {
            new Date - d > c && (700 === c && (c = 150), d = new Date, a.spinUp(), c--, 20 > c && (c = 20))
        }, 20), b.once("mouseup", function() {
            clearInterval(a.spinInterval)
        })
    },
    onMouseDownSpinDown: function() {
        var a = this, b = Fancy.get(document), c = 700, d = new Date;
        a.spinDown(), a.spinInterval = setInterval(function() {
            new Date - d > c && (700 === c && (c = 150), d = new Date, a.spinDown(), c--, 20 > c && (c = 20))
        }, 20), b.once("mouseup", function() {
            clearInterval(a.spinInterval)
        })
    },
    spinUp: function() {
        var a = this, b =+ a.get() + a.step;
        isNaN(b) && (b = a.min || 0), void 0 !== a.max && b > a.max ? b = a.max : b < a.min && (b = a.min), a.set(b)
    },
    spinDown: function() {
        var a = this, b =+ a.get() - a.step;
        isNaN(b) && (b = a.min || 0), void 0 !== a.min && b < a.min ? b = a.min : b > a.max && (b = a.max), a.set(b)
    }
}), Fancy.define(["Fancy.form.field.TextArea", "Fancy.TextArea"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.textarea",
    constructor: function() {
        var a = this;
        a.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "up", "down", "change", "key"), a.Super("init", arguments), a.preRender(), a.render(), a.ons()
    },
    fieldCls: "fancy fancy-field fancy-textarea",
    value: "",
    width: 250,
    height: 100,
    labelWidth: 60,
    inputWidth: 180,
    minHeight: 100,
    maxHeight: 210,
    lineHeight: 12.5,
    emptyText: "",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-textarea-text">', '<textarea autocomplete="off" placeholder="{emptyText}" type="text" class="fancy-textarea-text-input" style="{inputWidth}height:{height}px;">{value}</textarea>', '<div class="fancy-field-error" style="{errorTextStyle}"></div>', "</div>", '<div class="fancy-clearfix"></div>'],
    ons: function() {
        var a = this, b = a.el.getByTag("textarea");
        a.input = b, b.on("blur", a.onBlur, a), b.on("focus", a.onFocus, a), b.on("input", a.onInput, a), b.on("keydown", a.onKeyDown, a), a.autoHeight && b.on("input", a.onChange, a)
    },
    preRender: function() {
        var a = this;
        a.tpl && (a.tpl = new Fancy.Template(a.tpl)), a.initHeight(), a.calcSize()
    },
    initHeight: function() {
        var a, b = this;
        a = b.value ? b.value.match(/\n/g).length * b.lineHeight : b.height, a < b.minHeight ? a = b.minHeight : a > b.maxHeight && (a = b.maxHeight, setTimeout(function() {
            b.input.css({
                "overflow-y": "scroll"
            })
        }, 1)), b.height = a, b.inputHeight = a
    },
    onChange: function() {
        var a = this, b = a.input.dom.value, c = a.el.getByTag("textarea"), d = b.match(/\n/g).length * a.lineHeight;
        d < a.minHeight ? (d = a.minHeight, c.css({
            "overflow-y": "hidden"
        })) : d > a.maxHeight ? (d = a.maxHeight, c.css({
            "overflow-y": "scroll"
        })) : c.css({
            "overflow-y": "hidden"
        }), a.height = d
    }
}), Fancy.define(["Fancy.form.field.CheckBox", "Fancy.CheckBox"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.checkbox",
    constructor: function(a) {
        var b = this;
        Fancy.applyConfig(b, a || {}), b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "up", "down", "beforechange", "change", "key"), a.Super("init", arguments), a.preRender(), a.render({
            labelWidth: a.labelWidth,
            labelDispay: a.labelText ? "": "none",
            label: a.label
        }), a.acceptedValue = a.value, a.set(a.value, !1), a.ons()
    },
    labelText: "",
    labelWidth: 60,
    value: !1,
    checkedCls: "fancy-checkbox-on",
    fieldCls: "fancy fancy-field fancy-field-checkbox",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', '<div class="fancy-field-checkbox-input" style=""></div>', "</div>", '<div class="fancy-field-input-label" style="inputLabelDisplay">', "{inputLabel}", "</div>", '<div class="fancy-clearfix"></div>'],
    ons: function() {
        var a = this, b = a.el;
        b.on("click", a.onClick, a), b.on("mousedown", a.onMouseDown, a)
    },
    onClick: function() {
        var a = this, b = a.el, c = a.checkedCls;
        if (a.fire("beforechange"), a.canceledChange===!0)
            return void(a.canceledChange=!0);
        b.toggleClass(c);
        var d = a.value;
        a.value = b.hasClass(c), a.fire("change", a.value, d)
    },
    onMouseDown: function(a) {
        a.preventDefault()
    },
    set: function(a, b) {
        var c = this, d = c.el, e = c.checkedCls;
        if ("" === a && (a=!1), a===!0 || 1 === a)
            d.addClass(e), a=!0;
        else {
            if (a!==!1 && 0 !== a)
                throw new Error("not right value for checkbox " + a);
            d.removeClass(e), a=!1
        }
        c.value = a, b!==!1 && c.fire("change", c.value)
    },
    setValue: function(a, b) {
        this.set(a, b)
    },
    getValue: function() {
        var a = this;
        return a.value
    },
    get: function() {
        return this.getValue()
    },
    clear: function() {
        this.set(!1)
    },
    toggle: function() {
        var a = this;
        a.set(!a.value)
    }
}), Fancy.define(["Fancy.form.field.Switcher", "Fancy.Switcher"], {
    extend: Fancy.CheckBox,
    type: "field.switcher",
    constructor: function(a) {
        var b = this;
        Fancy.applyConfig(b, a || {}), b.Super("const", arguments)
    },
    init: function() {
        this.Super("init", arguments)
    },
    checkedCls: "fancy-switcher-on",
    fieldCls: "fancy fancy-field fancy-field-switcher",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', "</div>", '<div class="fancy-field-input-label" style="inputLabelDisplay">', "{inputLabel}", "</div>", '<div class="fancy-clearfix"></div>']
}), Fancy.define(["Fancy.form.field.Combo", "Fancy.Combo"], {
    type: "field.combo",
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    selectedItemCls: "fancy-combo-item-selected",
    width: 250,
    labelWidth: 60,
    listRowHeight: 25,
    dropButtonWidth: 27,
    emptyText: "",
    editable: !0,
    typeAhead: !0,
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', '<div class="fancy-combo-input-container" style="{inputWidth}{inputHeight}">', '<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}{inputHeight}cursor:default;" value="{value}">', '<div class="fancy-combo-dropdown-button">&nbsp;</div>', "</div>", '<div class="fancy-field-error" style="{errorTextStyle}"></div>', '<div class="fancy-clearfix"></div>'],
    constructor: function() {
        var a = this;
        a.tags = a.tags || [], a.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "up", "down", "change", "key", "enter", "up", "down", "esc"), a.Super("init", arguments), a.loadListData(), a.preRender(), a.render(), a.ons(), a.applyStyle(), a.applyTheme()
    },
    loadListData: function() {
        var a = this;
        if (Fancy.isObject(a.data)) {
            var b = a.data.proxy;
            if (!b ||!b.url)
                throw new Error("[FancyGrid Error]: combo data url is not defined");
            Fancy.Ajax({
                url: b.url,
                params: b.params || {},
                method: b.method || "GET",
                getJSON: !0,
                success: function(b) {
                    a.data = a.configData(b.data), a.renderList(), a.onsList()
                }
            })
        }
    },
    configData: function(a) {
        return a
    },
    applyStyle: function() {
        var a = this;
        a.hidden && a.el.css("display", "none"), a.style && a.el.css(a.style)
    },
    applyTheme: function() {
        var a = this;
        a.theme && "default" !== a.theme && (a.el.addClass("fancy-theme-" + a.theme), a.list.addClass("fancy-theme-" + a.theme))
    },
    fieldCls: "fancy fancy-field fancy-combo",
    ons: function() {
        var a = this, b = a.el.select(".fancy-combo-dropdown-button");
        a.input = a.el.getByTag("input"), a.inputContainer = a.el.select(".fancy-combo-input-container"), a.drop = b, a.onsList(), a.input.on("mousedown", a.onInputMouseDown, a), a.input.on("click", a.onInputClick, a), b.on("mousedown", a.onDropMouseDown, a), b.on("click", a.onDropClick, a), a.typeAhead && a.editable && a.input.on("keydown", a.onKeyDown, a), a.on("esc", a.onEsc, a), a.on("enter", a.onEnter, a), a.on("up", a.onUp, a), a.on("down", a.onDown, a)
    },
    onKeyDown: function(a) {
        var b = this, c = a.keyCode, d = Fancy.key;
        switch (c) {
        case d.ESC:
            b.fire("esc", a);
            break;
        case d.ENTER:
            b.fire("enter", a);
            break;
        case d.UP:
            b.fire("up", a);
            break;
        case d.DOWN:
            b.fire("down", a);
            break;
        case d.TAB:
            break;
        default:
            setTimeout(function() {
                return 0 === b.generateAheadData().length ? void b.hideAheadList() : (b.renderAheadList(), void b.showAheadList())
            }, 1)
        }
    },
    onInputClick: function(a) {
        var b = this, c = b.list;
        b.editable!==!0 && ("none" === c.css("display") ? b.showList() : b.hideList())
    },
    onDropClick: function(a) {
        var b = this, c = b.list;
        "none" === c.css("display") ? b.showList() : b.hideList(), b.editable===!0 && b.input.focus()
    },
    showList: function() {
        var a = this, b = a.list, c = a.input.parent().parent(), d = c.$dom.offset(), e = [d.left, d.top + c.$dom.height()], f = Fancy.get(document), g = a.selectedItemCls;
        if (a.hideAheadList(), a.list) {
            b.css({
                display: "",
                left: e[0] + "px",
                top: e[1] + "px",
                width: c.width(),
                "z-index": 2e3 + Fancy.zIndex++
            });
            var h;
            0 === b.select("." + g).length ? (b.select("li").item(0).addClass(g), h = 0) : h = b.select("." + g).item(0).index(), a.docSpy || (a.docSpy=!0, f.on("click", a.onDocClick, a))
        }
    },
    showAheadList: function() {
        var a = this, b = a.aheadList, c = a.input.parent().parent(), d = c.$dom.offset(), e = [d.left, d.top + c.$dom.height()], f = Fancy.get(document);
        a.hideList(), b && (b.css({
            display: "",
            left: e[0] + "px",
            top: e[1] + "px",
            width: c.width(),
            "z-index": 2e3 + Fancy.zIndex++
        }), a.docSpy2 || (a.docSpy2=!0, f.on("click", a.onDocClick, a)))
    },
    onDocClick: function(a) {
        var b = this;
        b.input.parent().parent().within(a.target)===!1 && (b.hideList(), b.hideAheadList())
    },
    hideList: function() {
        var a = this;
        if (a.list && (a.list.css("display", "none"), a.docSpy)) {
            var b = Fancy.get(document);
            a.docSpy=!1, b.un("click", a.onDocClick, a)
        }
    },
    hideAheadList: function() {
        var a = this;
        if (a.aheadList && (a.aheadList.css("display", "none"), a.docSpy)) {
            var b = Fancy.get(document);
            a.docSpy=!1, b.un("click", a.onDocClick, a)
        }
    },
    onInputMouseDown: function(a) {
        var b = this;
        b.editable===!1 && a.preventDefault()
    },
    onDropMouseDown: function(a) {
        a.preventDefault()
    },
    onsList: function() {
        var a = this;
        a.list.on("click", a.onListItemClick, a, "li")
    },
    onsAheadList: function() {
        var a = this;
        a.aheadList.on("click", a.onListItemClick, a, "li")
    },
    onListItemClick: function(a) {
        var b = this, c = Fancy.get(a.currentTarget), d = c.attr("value");
        Fancy.nojQuery && 0 === d && (d = ""), b.set(d), b.hideList(), b.onBlur()
    },
    set: function(a, b) {
        for (var c = this, d = "", e = 0, f = c.data.length, g=!1; f > e; e++)
            if (c.data[e][c.valueKey] == a) {
                c.valueIndex = e, d = c.data[e][c.displayKey], g=!0;
                break
            }
        c.selectItem(e), g===!1 && ( - 1 !== a && a && a.length > 0 ? (d = a, c.value =- 1, c.valueIndex =- 1) : d = ""), c.input.dom.value = d, c.value = a, b!==!1 && c.onInput()
    },
    selectItem: function(a) {
        var b = this;
        b.clearListActive(), b.list.select("li").item(a).addClass(b.selectedItemCls)
    },
    render: function() {
        var a = this, b = Fancy.get(a.renderTo || document.body).dom, c = Fancy.get(document.createElement("div")), d = a.value;
        if (c.attr("id", a.id), void 0 === d)
            d = "";
        else {
            for (var e = 0, f = a.data.length, g=!1; f > e; e++)
                if (a.data[e][a.valueKey] === d) {
                    a.valueIndex = e, d = a.data[e][a.displayKey], g=!0;
                    break
                }
            g===!1 && (d = "")
        }
        a.fire("beforerender"), c.addClass(a.cls), c.addClass(a.fieldCls);
        var h = "";
        a.labelWidth && (h = "width:" + a.labelWidth + "px;");
        var i = a.labelWidth + 8 + 10;
        "top" === a.labelAlign && (i = 8), "right" === a.labelAlign && (i = 8);
        var j = a.label;
        "" === a.label ? j = "&nbsp;" : void 0 === a.label ? j = "&nbsp;" : "right" !== a.labelAlign && (j += ":"), c.update(a.tpl.getHTML({
            labelWidth: h,
            labelDisplay: a.label===!1 ? "display: none;": "",
            label: j===!1 ? "": j,
            emptyText: a.emptyText,
            inputHeight: "height:" + a.inputHeight + "px;",
            value: d
        })), a.el = c, a.setStyle(), a.input = a.el.getByTag("input"), a.inputContainer = a.el.select(".fancy-combo-input-container"), a.drop = a.el.select(".fancy-combo-dropdown-button"), a.setSize(), b.appendChild(c.dom), "top" === a.labelAlign ? a.el.addClass("fancy-field-label-align-top") : "right" === a.labelAlign && (a.el.addClass("fancy-field-label-align-right"), $(c.dom).find(".fancy-field-label").insertAfter($(c.dom).find(".fancy-field-text"))), a.valueIndex && (a.acceptedValue = a.value), a.editable && a.input.css("cursor", "auto"), a.renderList(), a.fire("afterrender"), a.fire("render")
    },
    renderList: function() {
        var a = this, b = Fancy.get(document.createElement("div")), c = ['<ul style="position: relative;">'];
        a.list && a.list.destroy(), Fancy.each(a.data, function(b, d) {
            var e = "", f = b[a.displayKey], g = b[a.valueKey];
            a.value === g && (e = a.selectedItemCls), ("" === f || " " === f) && (f = "&nbsp;"), c.push('<li value="' + g + '" class="' + e + '"><span class="fancy-combo-list-value">' + f + "</span></li>")
        }), c.push("</ul>"), b.addClass("fancy fancy-combo-result-list"), b.update(c.join("")), b.css({
            display: "none",
            left: "0px",
            top: "0px",
            width: a.inputWidth + 14
        }), a.data.length > 9 && b.css({
            height: 9 * a.listRowHeight + "px",
            overflow: "auto"
        }), document.body.appendChild(b.dom), a.list = b
    },
    generateAheadData: function() {
        for (var a = this, b = a.input.dom.value.toLocaleLowerCase(), c = a.data, d = [], e = 0, f = c.length; f > e; e++)
            new RegExp("^" + b).test(c[e][a.displayKey].toLocaleLowerCase()) && d.push(c[e]);
        return a.data.length === d.length && (d = []), a.aheadData = d, d
    },
    renderAheadList: function() {
        var a, b = this, c = ['<ul style="position: relative;">'], d=!1;
        b.aheadList ? (b.aheadList.firstChild().destroy(), a = b.aheadList, d=!0) : a = Fancy.get(document.createElement("div")), Fancy.each(b.aheadData, function(a, d) {
            var e = "", f = a[b.displayKey], g = a[b.valueKey];
            0 === d && (e = b.selectedItemCls), ("" === f || " " === f) && (f = "&nbsp;"), c.push('<li value="' + g + '" class="' + e + '"><span class="fancy-combo-list-value">' + f + "</span></li>")
        }), c.push("</ul>"), a.update(c.join("")), a.css({
            display: "none",
            left: "0px",
            top: "0px",
            width: b.inputWidth + 14
        }), b.aheadData.length > 9 && a.css({
            height: 9 * b.listRowHeight + "px",
            overflow: "auto"
        }), d===!1 && (a.addClass("fancy fancy-combo-result-list"), document.body.appendChild(a.dom), b.aheadList = a, b.onsAheadList())
    },
    hide: function() {
        var a = this;
        a.el.css("display", "none"), a.hideList(), a.hideAheadList()
    },
    clear: function() {
        var a = this;
        a.set( - 1, !1)
    },
    clearListActive: function() {
        var a = this, b = a.selectedItemCls;
        a.list.select("." + b).removeClass(b)
    },
    onInput: function() {
        var a = this, b = a.getValue(), c = a.acceptedValue;
        a.acceptedValue = a.get(), a.fire("change", b, c)
    },
    setValue: function(a, b) {
        this.set(a, b)
    },
    getDisplayValue: function(a) {
        for (var b = this, c = 0, d = b.data.length; d > c; c++)
            if (b.data[c][b.valueKey] == a)
                return b.data[c][b.displayKey]
    },
    getValueKey: function(a) {
        for (var b = this, c = 0, d = b.data.length; d > c; c++)
            if (b.data[c][b.displayKey] === a)
                return b.data[c][b.valueKey]
    },
    get: function() {
        return this.getValue()
    },
    getValue: function() {
        var a = this;
        return - 1 === a.value || void 0 === a.value?-1 === a.value && a.input.dom.value ? a.input.dom.value : "" : void 0 !== a.valueKey ? a.value : a.value
    },
    size: function(a) {
        var b = this, c = a.width, d = a.height, e = b.el, f = b.input, g = b.inputContainer, h = b.drop;
        "top" !== b.labelAlign && (b.inputHeight = d), void 0 !== d && (b.height = d), void 0 !== c && (b.width = c), b.calcSize(), "top" === b.labelAlign ? e.css({
            height: 1.5 * b.height,
            width: b.width
        }) : e.css({
            height: b.height,
            width: b.width
        });
        var i = b.inputWidth;
        b.label===!1 && (i = b.width), f.css({
            width: i - 2,
            height: b.inputHeight
        }), g.css({
            width: i,
            height: b.inputHeight
        }), h.css("height", b.inputHeight)
    },
    onEnter: function(a, b) {
        var c = this, d = c.getActiveList();
        if (d) {
            var e = d.select("." + c.selectedItemCls + " .fancy-combo-list-value").dom.innerHTML;
            c.set(e)
        } else 
            c.set(c.input.dom.value);
        c.hideList(), c.hideAheadList()
    },
    onEsc: function(a, b) {
        var c = this;
        c.hideList(), c.hideAheadList()
    },
    onUp: function(a, b) {
        var c = this, d = c.getActiveList(), e = c.selectedItemCls;
        if (d) {
            b.preventDefault();
            var f = d.select("." + e), g = f.index(), h = d.select("li");
            parseInt(d.css("height"));
            0 !== g ? g-- : g = h.length - 1;
            var i = h.item(g), j = i.offset().top;
            g === h.length - 1 ? d.dom.scrollTop = 1e4 : j - parseInt(i.css("height")) < parseInt(i.css("height")) && (d.dom.scrollTop = d.dom.scrollTop - parseInt(f.css("height"))), f.removeClass(e), i.addClass(e)
        }
    },
    onDown: function(a, b) {
        var c = this, d = c.getActiveList(), e = c.selectedItemCls;
        if (d) {
            b.preventDefault();
            var f = d.select("." + e), g = f.index(), h = d.select("li"), i = f.offset().top, j = parseInt(d.css("height"));
            g !== h.length - 1 ? g++ : g = 0;
            var k = h.item(g);
            i - j > 0 ? d.dom.scrollTop = 0 : i - j>-parseInt(f.css("height")) && (d.dom.scrollTop = d.dom.scrollTop + (i - j) + parseInt(f.css("height"))), f.removeClass(e), k.addClass(e)
        } else 
            c.showList()
    },
    scrollToListItem: function(a) {
        var b = this, c = b.getActiveList(), d = c.select("li"), e = d.item(a), f = e.offset().top;
        parseInt(c.css("height")), c.dom.scrollTop;
        0 === a ? c.dom.scrollTop = 0 : a === d.length - 1 ? c.dom.scrollTop = 1e4 : c.dom.scrollTop = f
    },
    getActiveList: function() {
        var a = this, b=!1;
        return a.list && "none" !== a.list.css("display") ? b = a.list : a.aheadList && "none" !== a.aheadList.css("display") && (b = a.aheadList), b
    }
}), Fancy.define(["Fancy.form.field.Button", "Fancy.ButtonField"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.button",
    pressed: !1,
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("click"), a.Super("init", arguments), a.preRender(), a.render(), a.renderButton(), a.ons(), a.hidden && a.el.css("display", "none"), a.style && a.el.css(a.style)
    },
    fieldCls: "fancy fancy-field fancy-field-button",
    value: "",
    width: 100,
    emptyText: "",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', "</div>", '<div class="fancy-clearfix"></div>'],
    renderButton: function() {
        var a = this;
        new Fancy.Button({
            renderTo: a.el.select(".fancy-field-text").item(0).dom,
            text: a.buttonText,
            handler: function() {
                a.handler && a.handler()
            }
        })
    },
    ons: function() {},
    onClick: function() {
        var a = this;
        a.fire("click"), a.handler && a.handler()
    }
}), Fancy.define(["Fancy.form.field.SegButton", "Fancy.SegButtonField"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.button",
    allowToggle: !0,
    constructor: function(a) {
        var b = this, a = a || {};
        Fancy.apply(b, a), b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("click", "change"), a.Super("init", arguments), a.preRender(), a.render(), a.renderButton(), a.ons(), a.hidden && a.el.css("display", "none"), a.style && a.el.css(a.style)
    },
    fieldCls: "fancy fancy-field fancy-field-button",
    value: "",
    width: 100,
    emptyText: "",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", "</div>", '<div class="fancy-field-text">', "</div>", '<div class="fancy-clearfix"></div>'],
    renderButton: function() {
        var a = this;
        new Fancy.SegButton({
            renderTo: a.el.select(".fancy-field-text").item(0).dom,
            items: a.items,
            multiToggle: a.multiToggle,
            allowToggle: a.allowToggle
        })
    },
    ons: function() {},
    onClick: function() {
        var a = this;
        a.fire("click"), a.handler && a.handler()
    },
    get: function() {
        for (var a = this, b = a.items, c = 0, d = b.length, e = []; d > c; c++) {
            var f = b[c];
            f.pressed && (f.value ? e.push(f.value) : e.push(c))
        }
        return e.toString()
    },
    clear: function() {
        var a = this, b = a.items, c = 0, d = b.length;
        if (a.allowToggle)
            for (; d > c; c++)
                b[c].setPressed(!1)
    }
}), Fancy.define(["Fancy.form.field.Radio", "Fancy.Radio"], {
    mixins: [Fancy.form.field.Mixin],
    extend: Fancy.Widget,
    type: "field.radio",
    constructor: function() {
        var a = this;
        a.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.addEvents("focus", "blur", "input", "up", "down", "change", "key"), a.Super("init", arguments);
        var b = "", c = a.items, d = 0, e = c.length;
        for (a.column && (a.cls += " fancy-field-radio-column", b += '<div style="margin-left: ' + a.labelWidth + 'px;">'); e > d; d++) {
            var f = c[d], g = "", h = "fancy-field-text";
            a.column || 0 === d || (g = "margin-left:10px;"), f.value === a.value && (h += " fancy-field-radio-on"), b += ['<div class="' + h + '" value=' + f.value + ">", '<div class="fancy-field-radio-input" style="float:left;' + g + '"></div>', '<div style="float:left;margin:7px 0px 0px 0px;">' + f.text + "</div>", "</div>"].join("")
        }
        a.column && (b += "</div>"), a.itemsHTML = b, a.preRender(), a.render(), a.acceptedValue = a.value, a.set(a.value), a.ons()
    },
    labelText: "",
    labelWidth: 60,
    value: !1,
    checkedCls: "fancy-field-radio-on",
    fieldCls: "fancy fancy-field fancy-field-radio",
    tpl: ['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">', "{label}", '<div class="fancy-field-error" style="{errorTextStyle}"></div>', "</div>", "{itemsHTML}", '<div class="fancy-clearfix"></div>'],
    ons: function() {
        var a = this, b = a.el;
        b.$dom.delegate(".fancy-field-text", "click", function() {
            a.set(Fancy.get(this).attr("value"))
        }), b.on("mousedown", a.onMouseDown, a)
    },
    onClick: function() {
        var a = this, b = a.el, c = a.checkedCls;
        a.addClass(c), b.toggleClass(c), a.value = b.hasClass(c), a.fire("change", a.value)
    },
    onMouseDown: function(a) {
        a.preventDefault()
    },
    set: function(a, b) {
        var c = this, d = c.el, e = c.checkedCls, f = d.select(".fancy-field-text");
        f.removeClass(e), d.select("[value=" + a + "]").addClass(e), c.value = a, b!==!1 && c.fire("change", c.value)
    },
    setValue: function(a, b) {
        this.set(a, b)
    },
    getValue: function() {
        var a = this;
        return a.value
    },
    get: function() {
        return this.getValue()
    },
    clear: function() {
        this.set(!1)
    }
}), function() {
    Fancy.vtypes = {}, Fancy.addValid = function(a, b) {
        Fancy.vtypes[a] = b
    }, Fancy.isValid = function(a, b) {
        var c;
        if (Fancy.isString(a) ? c = Fancy.vtypes[a] : Fancy.isObject(a) && (a.type ? (c = Fancy.vtypes[a.type], Fancy.applyIf(a, c)) : c = a), c.before) {
            var d = c.before, e = [a];
            Fancy.isString(d) ? e.push(d) : Fancy.isArray(d) && (e = e.concat(d)), e.reverse();
            for (var f = 0, g = e.length; g > f; f++)
                if (c = Fancy.isObject(e[f]) ? e[f] : Fancy.vtypes[e[f]], c.re) {
                    if (c.re.test(b)===!1)
                        return c
                } else if (c.fn && c.fn.apply(c, [b])===!1)
                    return c
        } else {
            if (c.re && c.re.test(b)===!1)
                return c;
            if (c.fn.apply(c, [b])===!1)
                return c
        }
        return !0
    }
}(), Fancy.addValid("notempty", {
    text: "Must be present",
    fn: function(a) {
        return null === a || void 0 === a?!1 : 0 !== String(a).length
    }
}), Fancy.addValid("notnan", {
    text: "Must be numeric",
    fn: function(a) {
        return !isNaN(a)
    }
}), Fancy.addValid("min", {
    before: ["notempty", "notnan"],
    text: "Must be must be at least {param}",
    fn: function(a) {
        return a > this.param
    }
}), Fancy.addValid("max", {
    before: ["notempty", "notnan"],
    text: "Must be no more than {param}",
    fn: function(a) {
        return a < this.param
    }
}), Fancy.addValid("range", {
    before: ["notempty", "notnan"],
    text: "Must be between {min} and {max}",
    fn: function(a) {
        return a >= this.min && a <= this.max
    }
}), Fancy.addValid("email", {
    before: "notempty",
    re: /^(")?(?:[^\."])(?:(?:[\.])?(?:[\w\-!#$%&'*+\/=?\^_`{|}~]))*\1@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,
    text: "Is not a valid email address"
}), Fancy.define("Fancy.Grid", {
    extend: Fancy.Widget,
    mixins: ["Fancy.grid.mixin.Grid", Fancy.panel.mixin.PrepareConfig, Fancy.panel.mixin.methods, "Fancy.grid.mixin.PrepareConfig", "Fancy.grid.mixin.ActionColumn", "Fancy.grid.mixin.Edit"],
    plugins: [{
        type: "grid.updater"
    }, {
        type: "grid.scroller"
    }, {
        type: "grid.licence"
    }
    ],
    type: "grid",
    theme: "default",
    i18n: "en",
    emptyText: "",
    prefix: "fancy-grid-",
    cls: "",
    widgetCls: "fancy-grid",
    cellCls: "fancy-grid-cell",
    cellInnerCls: "fancy-grid-cell-inner",
    cellEvenCls: "fancy-grid-cell-even",
    clsASC: "fancy-grid-column-sort-ASC",
    clsDESC: "fancy-grid-column-sort-DESC",
    clsSparkColumn: "fancy-grid-column-sparkline",
    clsSparkColumnBullet: "fancy-grid-column-sparkline-bullet",
    clsSparkColumnCircle: "fancy-grid-column-chart-circle",
    clsSparkColumnDonutProgress: "fancy-grid-column-spark-progress-donut",
    clsColumnGrossLoss: "fancy-grid-column-grossloss",
    clsGroupRow: "fancy-grid-group-row",
    clsCollapsedRow: "fancy-grid-group-row-collapsed",
    rowOverCls: "fancy-grid-cell-over",
    cellOverCls: "fancy-grid-cell-over",
    cellSelectedCls: "fancy-grid-cell-selected",
    columnOverCls: "fancy-grid-column-over",
    columnSelectedCls: "fancy-grid-column-selected",
    filterHeaderCellCls: "fancy-grid-header-filter-cell",
    cellHeaderDoubleSize: "fancy-grid-header-cell-double-size",
    header: !0,
    shadow: !0,
    striped: !0,
    columnLines: !0,
    textSelection: !1,
    width: 200,
    height: 200,
    minWidth: 200,
    minHeight: 200,
    emptyValue: "&nbsp;",
    frame: !0,
    keyNavigation: !1,
    draggable: !1,
    activated: !1,
    constructor: function(a) {
        var b = this, a = a || {}, c = function(c) {
            c && Fancy.apply(a, c), a = b.prepareConfig(a, b), Fancy.applyConfig(b, a), b.Super("const", arguments)
        }, d = function() {
            var d = a.i18n || b.i18n;
            if (Fancy.loadLang(d, c)===!0) {
                a.lang;
                c({})
            }
        };
        Fancy.modules.grid || Fancy.fullBuilt || Fancy.MODULELOAD===!1 ? d() : Fancy.loadModule("grid", function() {
            d()
        })
    },
    init: function() {
        var a = this;
        return a.initId(), a.addEvents("beforerender", "afterrender", "render", "show", "hide", "destroy"), a.addEvents("headercellclick", "headercellmousemove", "headercellmousedown", "docmouseup", "docclick", "docmove", "init", "columnresize", "columnclick", "columndblclick", "columnenter", "columnleave", "columnmousedown", "cellclick", "celldblclick", "cellenter", "cellleave", "cellmousedown", "rowclick", "rowdblclick", "rowenter", "rowleave", "scroll", "remove", "set", "update", "sort", "beforeload", "load", "select", "clearselect", "activate", "deactivate", "beforeedit", "startedit"), Fancy.fullBuilt!==!0 && Fancy.MODULELOAD!==!1 && a.fullBuilt!==!0 && a.neededModules!==!0 && "datepicker" !== a.wtype && "monthpicker" !== a.wtype ? void a.loadModules() : (a.initStore(), a.initPlugins(), a.ons(), a.initDateColumn(), a.fire("beforerender"), a.preRender(), a.render(), a.initElements(), a.initActionColumnHandler(), a.fire("render"), a.fire("afterrender"), a.setSides(), a.setSidesHeight(), a.setColumnsPosition(), a.update(), a.initTextSelection(), a.initTouch(), void a.fire("init"))
    },
    loadModules: function() {
        var a = this, b = Fancy.modules || {}, c = {}, d = a.columns || [], e = a.leftColumns || [], f = a.rightColumns || [];
        Fancy.modules = b, Fancy.nojQuery && (c.dom=!0), Fancy.isTouch && (c.touch=!0), a.paging && (c.paging=!0), a.filter && (c.filter=!0), a.searching && (c.search=!0), Fancy.isObject(a.data) && (a.data.proxy && (c["server-data"]=!0, Fancy.nojQuery && (c.ajax=!0)), a.data.chart && (c["chart-integration"]=!0)), a.isGroupedHeader && (c["grouped-header"]=!0), a.grouping && (c.grouping=!0), (a.trackOver || a.columnTrackOver || a.cellTrackOver || a.selection) && (c.selection=!0);
        for (var g = d.concat(e).concat(f), h = 0, i = g.length; i > h; h++) {
            var j = g[h];
            switch (j.sortable===!0 && (c.sort=!0), j.editable===!0 && (c.edit=!0), j.filter && (c.filter=!0), j.type) {
            case"combo":
                j.data && j.data.proxy && (c.ajax=!0);
                break;
            case"progressbar":
            case"progressdonut":
            case"grossloss":
                c.spark=!0, c.tooltip=!0;
                break;
            case"date":
                c.date=!0, c.selection=!0
            }
            j.cellTip && (c.tooltip=!0)
        }(c.spark || c.edit) && (c.tooltip=!0), a.neededModules = {
            length: 0
        };
        for (var k in c)
            void 0 === Fancy.modules[k] && (a.neededModules[k]=!0, a.neededModules.length++);
        if (0 === a.neededModules.length)
            return a.neededModules=!0, void a.init();
        var l = function(b) {
            delete a.neededModules[b], a.neededModules.length--, 0 === a.neededModules.length && (a.neededModules=!0, a.init())
        };
        for (var k in a.neededModules)
            "length" !== k && Fancy.loadModule(k, l)
    }
});
var FancyGrid = Fancy.Grid;
FancyGrid.get = function(a) {
    var b = Fancy.get(a).select(".fancy-grid").dom.id;
    return Fancy.getWidget(b)
}, FancyGrid.defineTheme = Fancy.defineTheme, FancyGrid.defineController = Fancy.defineController, FancyGrid.addValid = Fancy.addValid, Fancy.nojQuery || Fancy.$ || (Fancy.$.fn.FancyGrid = function(a) {
    return a.renderTo = $(this.selector)[0].id, new Fancy.Grid(a)
}), Fancy.define("Fancy.grid.plugin.CellTip", {
    extend: Fancy.Plugin,
    ptype: "grid.celltip",
    inWidgetName: "celltip",
    cellTip: "{value}",
    constructor: function(a) {
        var b = this;
        b.Super("const", arguments)
    },
    init: function() {
        var a = this;
        a.Super("init", arguments), a.ons()
    },
    ons: function() {
        var a = this, b = a.widget, c = (b.store, Fancy.get(document));
        b.on("cellenter", a.onCellEnter, a), b.on("cellleave", a.onCellLeave, a), c.on("mousemove", a.onDocMove, a)
    },
    onCellEnter: function(a, b) {
        var c = this, d = b.column, e = c.cellTip, f = b.e;
        if (d.cellTip) {
            if (Fancy.isString(d.cellTip))
                e = d.cellTip;
            else if (Fancy.isFunction(d.cellTip) && (e = d.cellTip(b), e===!1))
                return;
            var g = new Fancy.Template(e), h = {
                title: d.title,
                value: b.value,
                columnIndex: 0,
                rowIndex: 0
            };
            Fancy.apply(h, b.data), c.tooltip && c.tooltip.destroy(), c.tooltip = new Fancy.ToolTip({
                text: g.getHTML(h)
            }), c.tooltip.el.css("display", "block"), c.tooltip.show(f.pageX + 15, f.pageY - 25)
        }
    },
    onCellLeave: function(a, b) {
        var c = this;
        c.tooltip && (c.tooltip.destroy(), delete c.tooltip)
    },
    onDocMove: function(a) {
        var b = this;
        b.tooltip&&!b.tooltipToDestroy && b.tooltip.show(a.pageX + 15, a.pageY - 25)
    }
});

